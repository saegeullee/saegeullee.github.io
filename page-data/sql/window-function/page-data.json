{"componentChunkName":"component---src-templates-post-template-js","path":"/sql/window-function","result":{"data":{"markdownRemark":{"id":"16886b1e-92c2-5fb3-b85e-bbf3c17674f3","html":"<h2 id=\"윈도우-함수란\"><a href=\"#%EC%9C%88%EB%8F%84%EC%9A%B0-%ED%95%A8%EC%88%98%EB%9E%80\" aria-label=\"윈도우 함수란 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>윈도우 함수란</h2>\n<p>윈도우 함수는 현재 행과 관련이 있는 테이블의 행 집합에 대한 계산이다. 이것은 일반적으로 현재 행을 통합하는 누계 계산(running totals) 또는\n현재 행을 포함하여 행에서 레코드 순위 지정을 하는 것을 의미한다.</p>\n<p>윈도우 함수는 group by 절과 결합된 집계 함수와 비슷하지만 한 가지 중요한 차이점이 있다. 윈도우 함수는 입력 테이블과 출력 테이블 (또는 결과) 사이의 총 행 수를 유지한다. 배후에서 window 함수는 쿼리 결과의 현재 행 이상에 액세스 할 수 있습니다.</p>\n<h2 id=\"윈도우-함수-용어\"><a href=\"#%EC%9C%88%EB%8F%84%EC%9A%B0-%ED%95%A8%EC%88%98-%EC%9A%A9%EC%96%B4\" aria-label=\"윈도우 함수 용어 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>윈도우 함수 용어</h2>\n<ul>\n<li>Partition by: A subclause of the OVER clause. Similar to GROUP BY.</li>\n<li>Over: Typically precedes the partition by that signals what to “GROUP BY”.</li>\n<li>Aggregates: Aggregate functions that are used in window functions, too (e.g., sum, count, avg).</li>\n<li>Row_number(): Ranking function where each row gets a different number.</li>\n<li>Rank(): Ranking function where a row could get the same rank if they have the same value.</li>\n<li>Dense_rank(): Ranking function similar to rank() but ranks are not skipped with ties.</li>\n<li>Aliases: Shorthand that can be used if there are several window functions in one query.</li>\n<li>Percentiles: Defines what percentile a value falls into over the entire table.</li>\n<li>Lag/Lead: Calculating differences between rows’ values.</li>\n</ul>\n<h2 id=\"core-윈도우-함수\"><a href=\"#core-%EC%9C%88%EB%8F%84%EC%9A%B0-%ED%95%A8%EC%88%98\" aria-label=\"core 윈도우 함수 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Core 윈도우 함수</h2>\n<h3 id=\"core-윈도우-함수-예시\"><a href=\"#core-%EC%9C%88%EB%8F%84%EC%9A%B0-%ED%95%A8%EC%88%98-%EC%98%88%EC%8B%9C\" aria-label=\"core 윈도우 함수 예시 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Core 윈도우 함수 예시</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 618px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/1f4f1944878341b9912326287a8ffcfb/ae9bf/core_window_function.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 38.02588996763754%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsSAAALEgHS3X78AAABcElEQVQoz5WRW1ODMBCF+f+/yAerU3X6oNVKb1Aol3IvBZoEaMG2HJeoffFFd+bM7iSZLzkniuW4WNs2XM+HaVHfeHBIurFGusvQV9d1UtdZ9gu6y28pnh8ijBLs8hxRnEiFUSyhe8Yl5NIf/ob+AJuqxLGs0NQ1jlUldTocoORJi0ocYa4NcMHw12oJZFoWZksNC30F23VxbhoocrM94/VRxdPNHbTxDObYga+7KKKQFKEIIpSsv7iFECUYY6g5IzexjMjzfWy36ReQF0cIenrqxVBvx1CHL5jeP+Nt+IDxYABvNEL4PkUeMLCiQbFnFE+GIk0JspXQLc1ZllEMFRR9kmIxM6BOVWw2Ln0E5RgFqMnStU4ndIcSF4qko5woVJzbBhZ95uRdxZIsxwT+6DOsaoGKyL2EEGSHg3EubV1F65wLORf0qjwIkIUBNMOUQG1lwHE3yJIEik23/EcOhd9rrWswlkvo87nsjmHQmo5PYnpWs0dJQP4AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n        <source\n          srcset=\"/static/1f4f1944878341b9912326287a8ffcfb/01472/core_window_function.webp 240w,\n/static/1f4f1944878341b9912326287a8ffcfb/222bd/core_window_function.webp 480w,\n/static/1f4f1944878341b9912326287a8ffcfb/e7ff6/core_window_function.webp 618w\"\n          sizes=\"(max-width: 618px) 100vw, 618px\"\n          type=\"image/webp\"\n        />\n        <source\n          srcset=\"/static/1f4f1944878341b9912326287a8ffcfb/0783d/core_window_function.png 240w,\n/static/1f4f1944878341b9912326287a8ffcfb/782f4/core_window_function.png 480w,\n/static/1f4f1944878341b9912326287a8ffcfb/ae9bf/core_window_function.png 618w\"\n          sizes=\"(max-width: 618px) 100vw, 618px\"\n          type=\"image/png\"\n        />\n        <img\n          class=\"gatsby-resp-image-image\"\n          src=\"/static/1f4f1944878341b9912326287a8ffcfb/ae9bf/core_window_function.png\"\n          alt=\"core_window_function\"\n          title=\"core_window_function\"\n          loading=\"lazy\"\n        />\n      </picture>\n  </a>\n    </span></p>\n<h3 id=\"core-윈도우-함수-syntax\"><a href=\"#core-%EC%9C%88%EB%8F%84%EC%9A%B0-%ED%95%A8%EC%88%98-syntax\" aria-label=\"core 윈도우 함수 syntax permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Core 윈도우 함수 Syntax</h3>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\">AGGREGATE_FUNCTION <span class=\"token punctuation\">(</span>column_1<span class=\"token punctuation\">)</span> <span class=\"token keyword\">OVER</span>\n <span class=\"token punctuation\">(</span><span class=\"token keyword\">PARTITION</span> <span class=\"token keyword\">BY</span> column_2 <span class=\"token keyword\">ORDER</span> <span class=\"token keyword\">BY</span> column_3<span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">AS</span> new_column_name<span class=\"token punctuation\">;</span></code></pre></div>\n<p>윈도우 함수를 사용하면 조인을 수행하지 않고도 한 행을 다른 행과 비교할 수 있다. 윈도우 함수는 시간에 따른 추이를 측정하거나 특정 열의 순위를 지정하려는 경우에 효과적이며 원본 데이터 집합을 축소하거나 압축하지 않고 총 행의 수를 유지한다.</p>\n<h3 id=\"quiz\"><a href=\"#quiz\" aria-label=\"quiz permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Quiz</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 960px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/059af1b9231ee35efb916d566c4d5722/5edb4/parch_posey_schema.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 62.33766233766234%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAABYlAAAWJQFJUiTwAAACLElEQVQoz31TaXPaUAz0//9LpExn2nCEUMA2xebwAb7vEwgBttIzoZ/aN6N5WFir3ZUs3W43PON6xf12FfeVgnN83x/5z89P8LHsPRYLGZO5gv5ExlxZYjZfwA9CSPxCFMX4MXxDfzRDbzjD9+EEjuvC9Xz8HIzwjfL98Yx+j5EkKTR9jcFwjIPrQdU24tne76nG6wADQh69vcOwHSgrHbbjwrRsLGQFv6izF8ZYalzkwDQtbLc7hESCGR8IyKPml8sFZVV3gHleII5jpElCfzrI0lQAMsOmPeIqCm2UZYmqbpBmOYqyQpZl0HUdhmEgTTPkRdkBZgTIcSBmiqJgs9kgebzA+bZtn0VN0wowjuPxiPV6TaxNnE6nv4A1dfX8EEEYwSbDmVkpikpiX4pBhGGI0/mMumlQFKVQdb8Dvu/DJclfxKQ7Z/9xsjxHFCdwHAeWZVIzW7DgZlxcVRX25CFH03RWSGwsj9t0/C4O7kNag9VKw1xWISsqFLVbDW7AivhmudvtVki2LEsolFoyvffSR+91gpfhlFbmHXPaMT8Innv3dVgNR/FgycxZLgdbkjHD8/mD/AvwQf5URYGmroUsllPRGvDqvE4VDKayYMg5luaRKo0mrC6XpGSF3c4QrCWejr7ewKFBqCRrR9PcGSaZnov8aDSGrG2x+K2LBWYwnjTvYRhFRManwQTCNs4LD2NC5i+AI6ZdZOr8ybHxDa0Ms/U9TwyJn/93/gC0Tn5DIll7VwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n        <source\n          srcset=\"/static/059af1b9231ee35efb916d566c4d5722/01472/parch_posey_schema.webp 240w,\n/static/059af1b9231ee35efb916d566c4d5722/222bd/parch_posey_schema.webp 480w,\n/static/059af1b9231ee35efb916d566c4d5722/620b9/parch_posey_schema.webp 960w,\n/static/059af1b9231ee35efb916d566c4d5722/28063/parch_posey_schema.webp 1440w,\n/static/059af1b9231ee35efb916d566c4d5722/55acb/parch_posey_schema.webp 1540w\"\n          sizes=\"(max-width: 960px) 100vw, 960px\"\n          type=\"image/webp\"\n        />\n        <source\n          srcset=\"/static/059af1b9231ee35efb916d566c4d5722/0783d/parch_posey_schema.png 240w,\n/static/059af1b9231ee35efb916d566c4d5722/782f4/parch_posey_schema.png 480w,\n/static/059af1b9231ee35efb916d566c4d5722/f570d/parch_posey_schema.png 960w,\n/static/059af1b9231ee35efb916d566c4d5722/8d0ff/parch_posey_schema.png 1440w,\n/static/059af1b9231ee35efb916d566c4d5722/5edb4/parch_posey_schema.png 1540w\"\n          sizes=\"(max-width: 960px) 100vw, 960px\"\n          type=\"image/png\"\n        />\n        <img\n          class=\"gatsby-resp-image-image\"\n          src=\"/static/059af1b9231ee35efb916d566c4d5722/f570d/parch_posey_schema.png\"\n          alt=\"parch_posey_schema\"\n          title=\"parch_posey_schema\"\n          loading=\"lazy\"\n        />\n      </picture>\n  </a>\n    </span></p>\n<ol>\n<li>Create a running total of <code class=\"language-text\">standard_amt_usd</code> (in the orders table) over order time with no date truncation.</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span>\n  standard_amt_usd<span class=\"token punctuation\">,</span>\n  <span class=\"token function\">SUM</span><span class=\"token punctuation\">(</span>standard_amt_usd<span class=\"token punctuation\">)</span> <span class=\"token keyword\">OVER</span>\n  <span class=\"token punctuation\">(</span><span class=\"token keyword\">ORDER</span> <span class=\"token keyword\">BY</span> occurred_at<span class=\"token punctuation\">)</span> <span class=\"token keyword\">AS</span> running_total\n<span class=\"token keyword\">FROM</span> orders</code></pre></div>\n<ol start=\"2\">\n<li>Now, modify your query from the previous quiz to include partitions. Still create a running total of <code class=\"language-text\">standard_amt_usd</code> (in the orders table) over order time, but this time, date truncate <code class=\"language-text\">occurred_at</code> by year and partition by that same year-truncated <code class=\"language-text\">occurred_at</code> variable. Your final table should have three columns: One with the amount being added for each row, one for the truncated date, and a final column with the running total within each year.</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> standard_amt_usd<span class=\"token punctuation\">,</span>\n       DATE_TRUNC<span class=\"token punctuation\">(</span><span class=\"token string\">'year'</span><span class=\"token punctuation\">,</span> occurred_at<span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> <span class=\"token keyword\">year</span><span class=\"token punctuation\">,</span>\n       <span class=\"token function\">SUM</span><span class=\"token punctuation\">(</span>standard_amt_usd<span class=\"token punctuation\">)</span> <span class=\"token keyword\">OVER</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">PARTITION</span> <span class=\"token keyword\">BY</span> DATE_TRUNC<span class=\"token punctuation\">(</span><span class=\"token string\">'year'</span><span class=\"token punctuation\">,</span> occurred_at<span class=\"token punctuation\">)</span> <span class=\"token keyword\">ORDER</span> <span class=\"token keyword\">BY</span> occurred_at<span class=\"token punctuation\">)</span> <span class=\"token keyword\">AS</span> running_total\n<span class=\"token keyword\">FROM</span> orders</code></pre></div>\n<p>result\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 729px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/6ca41fb5d227b9153d161f93497444e4/c2c20/window_function_parition_by1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 44.855967078189295%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsSAAALEgHS3X78AAABH0lEQVQoz1VSBw7EMAjL/396uuvKnuUwGWoroaQMY0xUTIn246Tz0mKlVrrvm1prZKyT+/OTGBtO1B7nJVZKr1POB9LGUoiJfIiUc6HMwVwKXdqQZlBt3Lr3WOXGjazz4kNtGnUq8g9AZ2cwq7BRAJYAAwucdcSRG2JkEmFNBL8COhhi1Jk8AZ33DOoWKM4F2G5hZuy7VkZGMkbo1seBJmgEXcHutx9dK4l3AEwA35QAfgXaa+Q27LEUbQw31GtxMwe7Cqw5fFMC+IXhxskQtQzBpwlD6MdF2wB8LsUxIBg+a1XOmSwz6V3fBgaeG7qxHJwzhg8vQjTkFzGflDIWOugXMxi6gtnODLb9pM93Yx1PeU6dYRUNv9vBm07rqf0BmBy/AVPwUbAAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n        <source\n          srcset=\"/static/6ca41fb5d227b9153d161f93497444e4/01472/window_function_parition_by1.webp 240w,\n/static/6ca41fb5d227b9153d161f93497444e4/222bd/window_function_parition_by1.webp 480w,\n/static/6ca41fb5d227b9153d161f93497444e4/c2606/window_function_parition_by1.webp 729w\"\n          sizes=\"(max-width: 729px) 100vw, 729px\"\n          type=\"image/webp\"\n        />\n        <source\n          srcset=\"/static/6ca41fb5d227b9153d161f93497444e4/0783d/window_function_parition_by1.png 240w,\n/static/6ca41fb5d227b9153d161f93497444e4/782f4/window_function_parition_by1.png 480w,\n/static/6ca41fb5d227b9153d161f93497444e4/c2c20/window_function_parition_by1.png 729w\"\n          sizes=\"(max-width: 729px) 100vw, 729px\"\n          type=\"image/png\"\n        />\n        <img\n          class=\"gatsby-resp-image-image\"\n          src=\"/static/6ca41fb5d227b9153d161f93497444e4/c2c20/window_function_parition_by1.png\"\n          alt=\"window_function_parition_by1\"\n          title=\"window_function_parition_by1\"\n          loading=\"lazy\"\n        />\n      </picture>\n  </a>\n    </span>\n…\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 722px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/e31b48055dcfaaed787e5a88aaa4b70e/fef0a/window_function_parition_by2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 50.13850415512465%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsSAAALEgHS3X78AAABKElEQVQoz22SgY6EIAxE/f9PvaiIgIKC3ZmynBJ3k6axpdPXdoc9Jgl7lHxdkktvjPttFxc2sS6o/89fIuk4ZVmden4zPmwoWp2XnEtnZ87ifFCzKDKLVc+4vilFYkoyI77HKKXUOhWsD9+CHkQUZMPFup+Ci13hD/1WQaqvzmmHAuTm+eAXYc0XubAi1lLwWTuQgqZUZ64GigOe+yEZxxonI7NZNM43fB+w32lGDDtkDeNDxFFIwY5PKzAfwmPk9TtJzfPHkdt0rU53SBJ27u1UIfvdHykpynij1IOiIa/c6oakXfyLkLZhJI7lSYmmz0luQt8TsoALfxPmntBYMUpYc/xXkJDkCVc+GyG7U/C+8H1ljsjcNBv5GycZ4fPzyhBknKS6d8Q/yKcNR8Kx61AAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n        <source\n          srcset=\"/static/e31b48055dcfaaed787e5a88aaa4b70e/01472/window_function_parition_by2.webp 240w,\n/static/e31b48055dcfaaed787e5a88aaa4b70e/222bd/window_function_parition_by2.webp 480w,\n/static/e31b48055dcfaaed787e5a88aaa4b70e/8f6d2/window_function_parition_by2.webp 722w\"\n          sizes=\"(max-width: 722px) 100vw, 722px\"\n          type=\"image/webp\"\n        />\n        <source\n          srcset=\"/static/e31b48055dcfaaed787e5a88aaa4b70e/0783d/window_function_parition_by2.png 240w,\n/static/e31b48055dcfaaed787e5a88aaa4b70e/782f4/window_function_parition_by2.png 480w,\n/static/e31b48055dcfaaed787e5a88aaa4b70e/fef0a/window_function_parition_by2.png 722w\"\n          sizes=\"(max-width: 722px) 100vw, 722px\"\n          type=\"image/png\"\n        />\n        <img\n          class=\"gatsby-resp-image-image\"\n          src=\"/static/e31b48055dcfaaed787e5a88aaa4b70e/fef0a/window_function_parition_by2.png\"\n          alt=\"window_function_parition_by2\"\n          title=\"window_function_parition_by2\"\n          loading=\"lazy\"\n        />\n      </picture>\n  </a>\n    </span></p>\n<h3 id=\"partition-by-and-aggregate-functions\"><a href=\"#partition-by-and-aggregate-functions\" aria-label=\"partition by and aggregate functions permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Partition By and Aggregate Functions</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 960px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/8677c5b70a7762a829e82859669bd424/e1419/partition_by_and_aggregate_functions.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 38.911454102355805%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsSAAALEgHS3X78AAABa0lEQVQoz41R2W7CMBDM//8XtKQHqQSUI4ftOKcDBAIiQJLpeiuqPvShkUZ7ZD07Hjvb3Q6BEAgiAT+MKEZQOuH8c7XBJgixXG8QJwmEirlv874f8Nfn1PUBQmokaYY0zxETWV4U0EmK1cZHKCSjqrZIs5z7RVnidruhbVuaLZHR/OF4xDAMRLhvsDNHrNcrJInmLX3fMWiCh4ahR3e/o+tsv+fYXi5omgYyjiFJudIa5/MZjt1CRxD5CSbPL5gv5lBK4XQ68YH9fo8jbX/UFj//6ppsUHwDa0NpDJzr9cqqDrsWr+47xuMRvKnHpBH56fs+pJRcP6KiGFK/qipkZIOQipXaBY4palR5AyEURqMRXNdlEkPbSvKqIH9s/oDtmdKgSFMmSLOMr2tMhZbEOanOEQWaCOmFg4BVaR74JrAqLH6TMlhdhqn3gTfPw9PExWy+gKNiRS9LIMmWyMbH9f6D2WxGpB6WyxXXX6C+UaKcpCY5AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n        <source\n          srcset=\"/static/8677c5b70a7762a829e82859669bd424/01472/partition_by_and_aggregate_functions.webp 240w,\n/static/8677c5b70a7762a829e82859669bd424/222bd/partition_by_and_aggregate_functions.webp 480w,\n/static/8677c5b70a7762a829e82859669bd424/620b9/partition_by_and_aggregate_functions.webp 960w,\n/static/8677c5b70a7762a829e82859669bd424/448fa/partition_by_and_aggregate_functions.webp 1231w\"\n          sizes=\"(max-width: 960px) 100vw, 960px\"\n          type=\"image/webp\"\n        />\n        <source\n          srcset=\"/static/8677c5b70a7762a829e82859669bd424/0783d/partition_by_and_aggregate_functions.png 240w,\n/static/8677c5b70a7762a829e82859669bd424/782f4/partition_by_and_aggregate_functions.png 480w,\n/static/8677c5b70a7762a829e82859669bd424/f570d/partition_by_and_aggregate_functions.png 960w,\n/static/8677c5b70a7762a829e82859669bd424/e1419/partition_by_and_aggregate_functions.png 1231w\"\n          sizes=\"(max-width: 960px) 100vw, 960px\"\n          type=\"image/png\"\n        />\n        <img\n          class=\"gatsby-resp-image-image\"\n          src=\"/static/8677c5b70a7762a829e82859669bd424/f570d/partition_by_and_aggregate_functions.png\"\n          alt=\"partition_by_and_aggregate_functions\"\n          title=\"partition_by_and_aggregate_functions\"\n          loading=\"lazy\"\n        />\n      </picture>\n  </a>\n    </span></p>\n<h2 id=\"ranking-윈도우-함수\"><a href=\"#ranking-%EC%9C%88%EB%8F%84%EC%9A%B0-%ED%95%A8%EC%88%98\" aria-label=\"ranking 윈도우 함수 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Ranking 윈도우 함수</h2>\n<h3 id=\"quiz-1\"><a href=\"#quiz-1\" aria-label=\"quiz 1 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Quiz</h3>\n<ol>\n<li>Select the <code class=\"language-text\">id</code>, <code class=\"language-text\">account_id</code>, and total variable from the orders table, then create a column called <code class=\"language-text\">total_rank</code> that ranks this total amount of paper ordered (from highest to lowest) for each account using a partition. Your final table should have these four columns.</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> id<span class=\"token punctuation\">,</span> account_id<span class=\"token punctuation\">,</span> total<span class=\"token punctuation\">,</span>\nRANK<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">OVER</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">PARTITION</span> <span class=\"token keyword\">BY</span> account_id <span class=\"token keyword\">ORDER</span> <span class=\"token keyword\">BY</span> total <span class=\"token keyword\">DESC</span><span class=\"token punctuation\">)</span> total_rank\n<span class=\"token keyword\">FROM</span> orders</code></pre></div>\n<p>result</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 730px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/e7b06a0d6e812c601f614bae46c4aa51/7b680/ranking_window_func.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 49.86301369863014%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsSAAALEgHS3X78AAABGklEQVQoz21SC67DIAzr/S/71tcP0CbNYocwJq2SJTBpcGyW1i5TVXuex2FWW7O/12rHWcipOulfKdXOUlgDXkTsta72v+2m/Dew7MdpwC1KoNHqRdUvum4hkt96Hbh23eRKbaMOWEqtPNCupnoBVEKJuHIAZ7gAtViTl8CT+w42PEv9NPRmuFWnwuRZp8HfEop0asaGUAck8dk//AkAj2awJpr52D4yxhbRXhf8ArOhMs3GGhyigBqAYdVQiLX2UG5XmMElqHB3zKEcfT+HQoVZ10OBrzn6CAXe4Pb88Ixai30+BfLXxbPkIxgZk41nc3LkNnzA/nD8UvjFdw9ndVS474dtjvBAaTy49AnAGXg+YqTMUGIS7UoTb0COEr5j/0hzAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n        <source\n          srcset=\"/static/e7b06a0d6e812c601f614bae46c4aa51/01472/ranking_window_func.webp 240w,\n/static/e7b06a0d6e812c601f614bae46c4aa51/222bd/ranking_window_func.webp 480w,\n/static/e7b06a0d6e812c601f614bae46c4aa51/ea96d/ranking_window_func.webp 730w\"\n          sizes=\"(max-width: 730px) 100vw, 730px\"\n          type=\"image/webp\"\n        />\n        <source\n          srcset=\"/static/e7b06a0d6e812c601f614bae46c4aa51/0783d/ranking_window_func.png 240w,\n/static/e7b06a0d6e812c601f614bae46c4aa51/782f4/ranking_window_func.png 480w,\n/static/e7b06a0d6e812c601f614bae46c4aa51/7b680/ranking_window_func.png 730w\"\n          sizes=\"(max-width: 730px) 100vw, 730px\"\n          type=\"image/png\"\n        />\n        <img\n          class=\"gatsby-resp-image-image\"\n          src=\"/static/e7b06a0d6e812c601f614bae46c4aa51/7b680/ranking_window_func.png\"\n          alt=\"ranking_window_func\"\n          title=\"ranking_window_func\"\n          loading=\"lazy\"\n        />\n      </picture>\n  </a>\n    </span></p>","fields":{"slug":"/sql/window-function","tagSlugs":["/tag/sql/"]},"frontmatter":{"date":"2020-11-28T20:50:37.121Z","description":"","tags":["sql"],"title":"SQL Window Functions","socialImage":"/media/image-2.jpg"}}},"pageContext":{"slug":"/sql/window-function"}},"staticQueryHashes":["251939775","3439816877","401334301"]}
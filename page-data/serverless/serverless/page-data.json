{"componentChunkName":"component---src-templates-post-template-js","path":"/serverless/serverless","result":{"data":{"markdownRemark":{"id":"ad941cfc-4fc5-5fea-b13d-e74f2b3ff64f","html":"<blockquote>\n<p><strong><a href=\"https://www.udacity.com/course/cloud-developer-nanodegree--nd9990\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">유다시티 Cloud developer 과정</a></strong> 수업을 듣고 정리한 내용입니다.</p>\n</blockquote>\n<h1 id=\"serverless란\"><a href=\"#serverless%EB%9E%80\" aria-label=\"serverless란 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Serverless란</h1>\n<p>서비리스라는 용어는 유행어일 뿐이다. 어떤 아키텍처 패턴이나 기술을 의미하는 용어가 아니다. 서버리스는 어떤 솔루션을 의미한다. 서버리스라는 키워드를 가지고 있는 대부분의 솔루션들은 다음의 특징들을 가지고 있다.</p>\n<ul>\n<li>서버는 더 이상의 고려할 부분이 아님(다른 사람에 의해 관리됨)</li>\n<li>스케일업, 스케일다운이 쉬움</li>\n<li>사용한 만큼 비용 지불(요청이 없을 때는 비용을 지불하지 않음)</li>\n<li>데이터 저장소는 예외(요청이 없더라도 데이터 저장하는 만큼 비용을 지불해야함)</li>\n<li>서버 관리자가 필요없음(서비스 운영에 신경쓰지 않아도됨. 어플리케이션의 비즈니스 로직에만 집중할 수 있음)</li>\n</ul>\n<h3 id=\"서버리스의-장점\"><a href=\"#%EC%84%9C%EB%B2%84%EB%A6%AC%EC%8A%A4%EC%9D%98-%EC%9E%A5%EC%A0%90\" aria-label=\"서버리스의 장점 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>서버리스의 장점</h3>\n<ul>\n<li>낮은 진입 장벽</li>\n<li>비용이 저렴함</li>\n<li>높은 가용성과 확장성</li>\n</ul>\n<h3 id=\"앞으로-수업에서-배울-것들\"><a href=\"#%EC%95%9E%EC%9C%BC%EB%A1%9C-%EC%88%98%EC%97%85%EC%97%90%EC%84%9C-%EB%B0%B0%EC%9A%B8-%EA%B2%83%EB%93%A4\" aria-label=\"앞으로 수업에서 배울 것들 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>앞으로 수업에서 배울 것들</h3>\n<ul>\n<li>서버리스란 무엇인가?</li>\n<li>Function as a Service(FaaS)</li>\n<li>간단한 함수와 이를 이벤트에 연결하는 방법</li>\n<li>함수가 실행되는 방법</li>\n<li>FaaS의 장점과 단점</li>\n</ul>\n<h2 id=\"서버리스-컴포넌트\"><a href=\"#%EC%84%9C%EB%B2%84%EB%A6%AC%EC%8A%A4-%EC%BB%B4%ED%8F%AC%EB%84%8C%ED%8A%B8\" aria-label=\"서버리스 컴포넌트 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>서버리스 컴포넌트</h2>\n<p>서버리스는 하나의 기술 또는 서비스를 의미하는 것이 아니라 여러개의 컴포넌트를 통합하여 지칭하는 용어이다.</p>\n<ul>\n<li>Faas : 개별 함수에 코드를 작성하고 플랫폼에 배포하여 실행시키는 서비스이다. (AWS Lambda, Google Cloud Functions, Azure Functions)</li>\n<li>Datastores: 데이터 스토리지(Amazon S3, Amazon DynamoDB, Firebase etc)</li>\n<li>Messaging: 하나의 어플리케이션에서 다른 어플리케이션으로 메시지를 보내주는 서비스(Amazon Simple Queue Service(SQS), Amazon Kinesis, Google Pub/Sub)</li>\n<li>Services: 우리가 서버를 관리하지 않아도 되는 기능들을 제공하는 모든 서비스들(인증, 머신러닝, 비디오 프로세싱, 빅데이터, 오케스트레이션 등)</li>\n</ul>\n<h2 id=\"fuction-as-a-servicefaas\"><a href=\"#fuction-as-a-servicefaas\" aria-label=\"fuction as a servicefaas permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Fuction as a Service(FaaS)</h2>\n<ul>\n<li>어플리케이션을 여러 개의 작은 함수로 쪼개는 것</li>\n<li>이벤트 드리븐(함수들이 외부의 이벤트 발생으로 인해 실행이 됨)</li>\n<li>함수 실행당 비용 지불</li>\n<li>나머지 모든 것들이 클라우드 프로바이더에 의해 핸들링 됨(서버 제공, 스케일업, 스케일다운, 설치와 업데이트, 서버 관리 등)</li>\n</ul>\n<h3 id=\"람다-함수-vs-aws-람다\"><a href=\"#%EB%9E%8C%EB%8B%A4-%ED%95%A8%EC%88%98-vs-aws-%EB%9E%8C%EB%8B%A4\" aria-label=\"람다 함수 vs aws 람다 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>람다 함수 VS AWS 람다</h3>\n<p>AWS 람다는 AWS에서 발생하는 이벤트에 대한 응답을 코드로 실행하는 컴퓨팅 서비스를 의미하고 람다 함수는 AWS 람다에서 실행되고 이벤트 소스에 연결된 단일 함수를 의미한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">//함수 예시(AWS Lambda)</span>\nexports<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">handler</span> <span class=\"token operator\">=</span> <span class=\"token parameter\">event</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> number <span class=\"token operator\">=</span> event<span class=\"token punctuation\">.</span>number<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> updateNum <span class=\"token operator\">=</span> number<span class=\"token operator\">++</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n    result<span class=\"token punctuation\">:</span> updateNum\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>AWS 람다에 함수를 배포할 때 두가지 파라미터에 대해 생각해야 한다. 첫번째는 memory이다. 함수가 실행되며 사용할 수 있는 최대 램 용량을 의미한다. 더 많은 메모리를 지정하면 더 빠른 CPU를 사용할 수 있고 이에 따라 더 많은 비용을 지불해야 한다. 두번째는 timeout이다. 함수가 실행되는데 필요한 최대 시간을 의미한다. 파라미터로 제공한 시간이 지나면 함수는 자동 종료된다.</p>\n<h3 id=\"aws-람다의-제한사항\"><a href=\"#aws-%EB%9E%8C%EB%8B%A4%EC%9D%98-%EC%A0%9C%ED%95%9C%EC%82%AC%ED%95%AD\" aria-label=\"aws 람다의 제한사항 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>AWS 람다의 제한사항</h3>\n<ul>\n<li>함수 실행당 최대 3GB의 메모리 사용가능</li>\n<li>함수는 15분 이상 실행될 수 없음</li>\n<li><code class=\"language-text\">/tmp</code> 폴더에만 파일을 쓸 수 있음(512MB 이내)</li>\n<li>동시에 실행될 수 있는 함수의 개수 제한 (디폴트로 함수의 인스턴스 1000개까지 병렬적으로 실행 가능)</li>\n<li>이벤트 사이즈는 6MB까지 가능(람다 함수를 동기(syncronously)로 호출할 경우 256KB까지 가능)</li>\n</ul>\n<p>AWS 람다 제한사항 최신 버전은 <a href=\"https://docs.aws.amazon.com/lambda/latest/dg/limits.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">여기서</a> 확인 가능</p>\n<h2 id=\"aws-람다-이벤트\"><a href=\"#aws-%EB%9E%8C%EB%8B%A4-%EC%9D%B4%EB%B2%A4%ED%8A%B8\" aria-label=\"aws 람다 이벤트 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>AWS 람다 이벤트</h2>\n<p>람다 함수와 테스트 event 객체를 다음과 같이 구성해볼 수 있다. 테스트 event 객체는 AWS 콘솔에서 생성된 람다 함수 대시보드 안에서 Test 버튼 왼쪽의 드롭다운 메뉴에서 Configure test events를 클릭하여 테스트 이벤트 객체를 구성할 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">//람다 함수</span>\nexports<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">handler</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Event: '</span><span class=\"token punctuation\">,</span> event<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n        result<span class=\"token punctuation\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Hello </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>event<span class=\"token punctuation\">.</span>name<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">//테스트 이벤트</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token string\">\"name\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"Serverless\"</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2 id=\"함수가-실행되는-방법\"><a href=\"#%ED%95%A8%EC%88%98%EA%B0%80-%EC%8B%A4%ED%96%89%EB%90%98%EB%8A%94-%EB%B0%A9%EB%B2%95\" aria-label=\"함수가 실행되는 방법 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>함수가 실행되는 방법</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 825px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/e3772c18b67227a1a4848e138be325e5/b66d4/aws_lambda_functions.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 46.18181818181818%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsSAAALEgHS3X78AAAB70lEQVQoz12Sy08TURTG5/9xo/4FbqqyceHKtXHjOxqDcYGa+EIJlqTRRCK21thu1BhiaKkSkCgKPmqDglBoLdD3Q0s7TKedOz+vtw8qd/LlTr6Tc873nXM1dpx8qczk3HemJGbCPzHMuuJLZo1QPsN0ZoNQIUu6WgUhsGXMtm35KxC2QKvX6+RyeUzTVImB6S8cvfyAkzfcHL/2kGgipfgPqTX2hrwcfO5iV9BLKDwBegWxQ5BmGAbFYolGo6GI1zMRTt/ycNHp5/wdL/H1tOL1xDesYQerrh6izgOIkR70dJSGlNhomCz+irCejaO1KwvbVvfEx3lOXH/EhcGnnO33kEjlFG9sVUknl8hIpFLLVDIrWKahYlk5iiN9+xj096FZlkW5vCm7WCr4Rirsdfq4cv8Zl4b8rKw1Fc4Wcuyee8uhyZfs+TTFeCwquxiYMs+s1wi+HyWy9BlN17dIJlOdGY6/CyvLvXd9nJOWVxNJxWdiX5m95+DFgAPf7f0UPYepZWPYLYd61UTIqW1bFtuWT910dwq2LVuVAiyMIRaD2AsBxI9X1PU/KvZvy+qTt9YmLNHcV1AqPHZ1mDP9j+WWR4hvZJsNW7C70M7tFG0X7FY4v5xgwD3K0JMxXL4Ahd+brbh8c8L6H13F2h3+AqEwgHqcgMjDAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n        <source\n          srcset=\"/static/e3772c18b67227a1a4848e138be325e5/8ac56/aws_lambda_functions.webp 240w,\n/static/e3772c18b67227a1a4848e138be325e5/d3be9/aws_lambda_functions.webp 480w,\n/static/e3772c18b67227a1a4848e138be325e5/0244e/aws_lambda_functions.webp 825w\"\n          sizes=\"(max-width: 825px) 100vw, 825px\"\n          type=\"image/webp\"\n        />\n        <source\n          srcset=\"/static/e3772c18b67227a1a4848e138be325e5/e4891/aws_lambda_functions.png 240w,\n/static/e3772c18b67227a1a4848e138be325e5/0ce91/aws_lambda_functions.png 480w,\n/static/e3772c18b67227a1a4848e138be325e5/b66d4/aws_lambda_functions.png 825w\"\n          sizes=\"(max-width: 825px) 100vw, 825px\"\n          type=\"image/png\"\n        />\n        <img\n          class=\"gatsby-resp-image-image\"\n          src=\"/static/e3772c18b67227a1a4848e138be325e5/b66d4/aws_lambda_functions.png\"\n          alt=\"AWS Lambda Functions\"\n          title=\"AWS Lambda Functions\"\n          loading=\"lazy\"\n          style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        />\n      </picture>\n  </a>\n    </span></p>\n<p>람다 함수를 실행시키기 위해 요청을 보내면, AWS 람다는 해당 함수를 실행시키기 위한 환경을 만든다. 특정 환경을 위한 컨테이너를 만들고 해당 함수 코드를 로드한다. 그리고 이 함수에 이벤트를 보낸다. 이와 같은 과정이 모든 요청에 대해 동일하게 반복된다.</p>\n<p>해당 요청에 대해 함수가 실행되어 응답을 보내주고 나면 이를 위해 만들어진 환경이 곧바로 제거되는 것은 아니다. 곧 이 함수에 대해 다른 요청이 들어올 수도 있기 때문이다. 그래서 만약 이 함수에 새로운 요청을 보내면 AWS 람다는 현재 존재하는 환경을 사용할 것이다.</p>\n<p>그리고 만약 오랜 시간동안 새로운 요청이 오지 않는다면, AWS 람다는 해당 환경들을 하나씩 제거하기 시작한다. 긴 시간동안 요청이 없었다면 함수를 곧바로 실행할 수 있는 환경이 없을 것이다. 따라서 새로운 요청에 응답하기 위한 새로운 환경이 만들어져야 한다.</p>\n<p>위와 같이 함수는 휘발성이다. 요청에 응답하기 위해 만들어진 환경은 10분~15분 정도 유지되고 더 이상 사용되지 않으면 이는 곧 제거된다. 만약 해당 환경이 4시간정도 계속해서 사용되더라도 해당 환경을 구성하는 컨테이너는 제거되고 함수를 실행하기 위한 다른 컨테이너가 만들어진다. 이렇게 동작하는 이유는 이렇게 함으로서 함수가 항상 최신의 OS 버전과 최신 업데이트가 적용된 환경에서 서비스를 할 수 있기 때문이다.</p>\n<h2 id=\"invocation-types구동-타입\"><a href=\"#invocation-types%EA%B5%AC%EB%8F%99-%ED%83%80%EC%9E%85\" aria-label=\"invocation types구동 타입 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Invocation types(구동 타입)</h2>\n<p>AWS 람다 함수를 구동(실행)시킬 때, 어떤 구동 타입으로 함수를 실행시킬지 결정할 수 있다.</p>\n<ul>\n<li>Request/Response (Syncronous call)</li>\n<li>Asyncronous invocation (Asyncronous call)</li>\n<li>Using AWS CLI</li>\n</ul>\n<p>다음과 같이 AWS CLI를 사용하여 함수를 구동시킬 수 있다. 하지만 어떤 이유에서인지 나의 환경에서는 <code class=\"language-text\">aws: error: the following arguments are required: outfile</code> 에러 메시지가 발생한다..</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">aws lambda invoke --function-name helloworld \\\n--invocation-type RequestResponse \\\n--log-type Tail --payload `{&quot;name&quot; : &quot;AWS Lambda&quot;}` \\\nresult.txt</code></pre></div>\n<p><code class=\"language-text\">invocation-type</code>을 Event로 줘서 비동기로 실행할 수도 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">aws lambda invoke --function-name helloworld \\\n--invocation-type Event \\\n--log-type Tail --payload `{&quot;name&quot; : &quot;AWS Lambda&quot;}` \\\nresult.txt</code></pre></div>\n<h3 id=\"에러-핸들링\"><a href=\"#%EC%97%90%EB%9F%AC-%ED%95%B8%EB%93%A4%EB%A7%81\" aria-label=\"에러 핸들링 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>에러 핸들링</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 742px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/b97b3acca9041babbfee481da9fbffe0/65b75/AWS_Lambda_Error_Handling.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 50.40431266846361%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsSAAALEgHS3X78AAACKElEQVQoz22R2U8TYRTF+zfqoy/wQCIYdxN5QHjBYFSUREl5KipuEQ0JtiyFLsOilaULSkushbaJBil2pp0uM9OZ/vzm00ZIvMnJ/e4395w5Z8bD33Ich6OjEs1Gg3JFZ+lDiuXYDsH1JIfHqtxpt9sStth12sjuzp1nbnls20ZTNUzTJJv9hl6tEPqYovvWBBdu++ga8OKPbsply7IwTAtT16gWv0oTLv+UYEM4KuSLNOoNNE3Dtkwinz5z6c5T+sdecXHkCe8jGzh2SyawWjaGWuJXZgu71ZIuTwl2IrsXpni7W8pWmj7h7sboC3qHfcwp2/LeMEzp0hZ5XXpLCJ6M7MLj2lZFZNd6qXSM07IIi2937d4UA4/ecPXuMwLKliQ1m00aTQOjWkbLZyTHtp3Tgp3I9XqdalUX0SyiG1+4fv85g+PTsgei/wSbwqWhlThOb/4/cq1Wk2Ku8P7+ARW1zNJ6nJ5BL5dHfPQMeXk7v0Jdr1JWVfEDVbGjoes1AZ2TfPfsKRaLdFAQOPp5yLQ/RHf/A/qGHtN1c5Spd/Mc/vhO7uCA7G6GneVV2fOFAvl8nlwuRzKZpCBmTyqVooNEIsleehffyxnO9g5x7sowZ84PMj75mr1MmoQgxVbXiEzPEltZYzseF5wEsViMUChMXMyeSCRCB+FwGCUaZdY/x5h3krGJSR56fczM+llRFILBIH5/gPmFBQKBAIuLi0TFvstVlD/9NxRKwbzDQt7dAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n        <source\n          srcset=\"/static/b97b3acca9041babbfee481da9fbffe0/8ac56/AWS_Lambda_Error_Handling.webp 240w,\n/static/b97b3acca9041babbfee481da9fbffe0/d3be9/AWS_Lambda_Error_Handling.webp 480w,\n/static/b97b3acca9041babbfee481da9fbffe0/28367/AWS_Lambda_Error_Handling.webp 742w\"\n          sizes=\"(max-width: 742px) 100vw, 742px\"\n          type=\"image/webp\"\n        />\n        <source\n          srcset=\"/static/b97b3acca9041babbfee481da9fbffe0/e4891/AWS_Lambda_Error_Handling.png 240w,\n/static/b97b3acca9041babbfee481da9fbffe0/0ce91/AWS_Lambda_Error_Handling.png 480w,\n/static/b97b3acca9041babbfee481da9fbffe0/65b75/AWS_Lambda_Error_Handling.png 742w\"\n          sizes=\"(max-width: 742px) 100vw, 742px\"\n          type=\"image/png\"\n        />\n        <img\n          class=\"gatsby-resp-image-image\"\n          src=\"/static/b97b3acca9041babbfee481da9fbffe0/65b75/AWS_Lambda_Error_Handling.png\"\n          alt=\"AWS_Lambda_Error_Handling\"\n          title=\"AWS_Lambda_Error_Handling\"\n          loading=\"lazy\"\n          style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        />\n      </picture>\n  </a>\n    </span></p>\n<p>AWS 람다에서 에러가 발생하면 어떻게 함수를 실행시켰는지에 따라 에러가 핸들링 되는 방법이 다르다.</p>\n<ol>\n<li>Request/Response(동기) 방법을 사용하여 함수를 실행시켰을 때 에러가 발생하면 함수를 호출한 클라이언트에게 즉시 에러를 반환한다.</li>\n<li>Aync(비동기) 방법을 사용하여 함수를 실행시켰을 때 에러가 발생하면 AWS 람다는 HTTP 202(accepted) 응답을 클라이언트에게 보내주고 이 요청을 내부적으로 Queue에 저장해놓는다. 추가적으로 람다 함수를 3번 호출하고 만약 이 모든 호출에 대해 전부 에러가 발생하면 이 이벤트(요청)를 <code class=\"language-text\">dead-letter-queue</code>에 저장해놓는다.\n이 큐에는 람다 함수가 응답에 대해 처리를 못하고 실패한 모든 이벤트를 저장해놓는 공간이다.</li>\n</ol>\n<h2 id=\"플랫폼-이벤트\"><a href=\"#%ED%94%8C%EB%9E%AB%ED%8F%BC-%EC%9D%B4%EB%B2%A4%ED%8A%B8\" aria-label=\"플랫폼 이벤트 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>플랫폼 이벤트</h2>\n<p>이제 조금 복잡한 AWS 람다 함수를 만들어본다. 이 함수를 실행시키기 위해 <code class=\"language-text\">CloudWatch</code>라는 서비스를 이용한다. 아래의 그림과 같이 클라우드워치 서비스를 통해 AWS 람다 함수를 주기적으로 호출하는 이벤트를 발생시킬 수 있다. 이 이벤트가 발생하면 람다 함수는 현재 실행되고있는 EC2 인스턴스의 목록을 얻고 이중 하나를 랜덤하게 종료시킨다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 960px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/45c9399b70c1d70e35e95099f1750ed7/1bcd6/AWS_Lambda_complex_function.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 33.80035026269702%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAABYlAAAWJQFJUiTwAAABDUlEQVQoz4VR2U3DQBDdRuiCQigAiUb4owYaoAZECcAfiI8IFHAi4U2ErRBkr73ey4+ZsSKWEImRnnbnfHOocRyRg2X37ktuTykhhoDgHQK9MUbxqz9JFMjCAZGTGPTnJK1XqOsa3nvRc0kpil3dnlzg6/ldjM1iDVPW4JLBBzRlAVNpJGIe7IC+t4QenekkZqhKzC/PsX26k3xnLdTN0Rk2j2+wY8ByXmBVajRNIx1sXh7wWcyoIETnMXks75wUMIsZ7k+Poa+vRB9sD1W+LmFaM3XYtui67mfkDJbYNZExjDFio+rYVh8Ibpg6JCJFqxTmX3vEYeEEBne5I/KRdzwdiOuo/IL/Yf/ih/zfxigeGiudBdMAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n        <source\n          srcset=\"/static/45c9399b70c1d70e35e95099f1750ed7/8ac56/AWS_Lambda_complex_function.webp 240w,\n/static/45c9399b70c1d70e35e95099f1750ed7/d3be9/AWS_Lambda_complex_function.webp 480w,\n/static/45c9399b70c1d70e35e95099f1750ed7/e46b2/AWS_Lambda_complex_function.webp 960w,\n/static/45c9399b70c1d70e35e95099f1750ed7/83a31/AWS_Lambda_complex_function.webp 1142w\"\n          sizes=\"(max-width: 960px) 100vw, 960px\"\n          type=\"image/webp\"\n        />\n        <source\n          srcset=\"/static/45c9399b70c1d70e35e95099f1750ed7/e4891/AWS_Lambda_complex_function.png 240w,\n/static/45c9399b70c1d70e35e95099f1750ed7/0ce91/AWS_Lambda_complex_function.png 480w,\n/static/45c9399b70c1d70e35e95099f1750ed7/b7c40/AWS_Lambda_complex_function.png 960w,\n/static/45c9399b70c1d70e35e95099f1750ed7/1bcd6/AWS_Lambda_complex_function.png 1142w\"\n          sizes=\"(max-width: 960px) 100vw, 960px\"\n          type=\"image/png\"\n        />\n        <img\n          class=\"gatsby-resp-image-image\"\n          src=\"/static/45c9399b70c1d70e35e95099f1750ed7/b7c40/AWS_Lambda_complex_function.png\"\n          alt=\"AWS_Lambda_complex_function\"\n          title=\"AWS_Lambda_complex_function\"\n          loading=\"lazy\"\n          style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        />\n      </picture>\n  </a>\n    </span></p>\n<p>이 프로젝트는 이 <a href=\"https://github.com/udacity/cloud-developer/tree/master/course-04/exercises/c4-demos-master/04-chaos-monkey\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">레포지토리</a>에 저장되어 있다. 이 프로젝트로 AWS 람다 함수를 만들기 위해 먼저 프로젝트 루트 디렉토리에서 <code class=\"language-text\">npm i</code>를 하여 디펜던시를 설치하고 zip으로 압축해야 한다. 여기서 제한사항은 압축된 zip 파일은 50MB를 넘으면 안되고 압축을 푼 폴더(AWS가 압축된 폴더를 unzipp 한다)는 250MB를 넘으면 안된다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">zip -r chaos-monkey.zip .</code></pre></div>\n<h2 id=\"추가-파라미터\"><a href=\"#%EC%B6%94%EA%B0%80-%ED%8C%8C%EB%9D%BC%EB%AF%B8%ED%84%B0\" aria-label=\"추가 파라미터 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>추가 파라미터</h2>\n<p>AWS 람다 함수는 event 외에 다른 파라미터를 받을 수 있다. 이 중에 2번째 파라미터는 아래의 예시와 같이 context이다. context는 람다 함수가 실행되고 있는 환경에 대한 정보를 제공한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">exports<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">handler</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">event<span class=\"token punctuation\">,</span> context</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> number <span class=\"token operator\">=</span> event<span class=\"token punctuation\">.</span>number<span class=\"token punctuation\">;</span>\n  <span class=\"token operator\">...</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 960px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/cbe7832e697bc6e0b4e3bf64248e8832/9926b/AWS_Lambda_Context.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 48.76543209876544%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABYlAAAWJQFJUiTwAAABJUlEQVQoz42S626DMAxGef/Hm6atqrapWy/c4UcJAQLxOObSVm2lRvoUMPbJZ5xgs/2S75+dvL1/6I4+N1upayss7728usgNuq4TY2o5V5VY2yioqowMw3CT+IpYweF4krZt9QXIBPISx4nsfvfytz+I65z0fS/OuTv17hJXIIUoy/IR3GkhStNMwjBSFUWhMe+HG/CSyzOdKhBQFMUSjrLWqkOSiCfJdBDwsix1N8bwD9a89YBudkiSuhyLcYPLAYfzQQCXDtiTJF310CFF6nCEnc/VmkCbxChMV2gmTdPoP0cPgbRK8mksZrrLcGhxAWb51DZ5AP1Vu3ctH8cp4xDgAqY4zwuNR/PQiOlw3AxyT4DcO4bBXazri4ghvl+/4/CZaPsfa6oE9mkTnqkAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n        <source\n          srcset=\"/static/cbe7832e697bc6e0b4e3bf64248e8832/8ac56/AWS_Lambda_Context.webp 240w,\n/static/cbe7832e697bc6e0b4e3bf64248e8832/d3be9/AWS_Lambda_Context.webp 480w,\n/static/cbe7832e697bc6e0b4e3bf64248e8832/e46b2/AWS_Lambda_Context.webp 960w,\n/static/cbe7832e697bc6e0b4e3bf64248e8832/0b716/AWS_Lambda_Context.webp 1296w\"\n          sizes=\"(max-width: 960px) 100vw, 960px\"\n          type=\"image/webp\"\n        />\n        <source\n          srcset=\"/static/cbe7832e697bc6e0b4e3bf64248e8832/e4891/AWS_Lambda_Context.png 240w,\n/static/cbe7832e697bc6e0b4e3bf64248e8832/0ce91/AWS_Lambda_Context.png 480w,\n/static/cbe7832e697bc6e0b4e3bf64248e8832/b7c40/AWS_Lambda_Context.png 960w,\n/static/cbe7832e697bc6e0b4e3bf64248e8832/9926b/AWS_Lambda_Context.png 1296w\"\n          sizes=\"(max-width: 960px) 100vw, 960px\"\n          type=\"image/png\"\n        />\n        <img\n          class=\"gatsby-resp-image-image\"\n          src=\"/static/cbe7832e697bc6e0b4e3bf64248e8832/b7c40/AWS_Lambda_Context.png\"\n          alt=\"AWS_Lambda_Context\"\n          title=\"AWS_Lambda_Context\"\n          loading=\"lazy\"\n          style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        />\n      </picture>\n  </a>\n    </span></p>\n<h1 id=\"rest-api\"><a href=\"#rest-api\" aria-label=\"rest api permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>REST API</h1>\n<h2 id=\"api-게이트웨이\"><a href=\"#api-%EA%B2%8C%EC%9D%B4%ED%8A%B8%EC%9B%A8%EC%9D%B4\" aria-label=\"api 게이트웨이 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>API 게이트웨이</h2>\n<ul>\n<li>API 사용자에게 진입점</li>\n<li>다른 서비스에게 요청을 전달</li>\n<li>요청을 처리</li>\n</ul>\n<p>Api 게이트웨이는 사용자가 보낸 HTTP 요청을 받아 이벤트로 변환하여 람다 함수를 호출하는 역할을 한다. 그리고 호출된 람다 함수가 비즈니스 로직을 수행한다. 뿐만 아니라 중간에서 인증, 보안, 로깅 캐싱 등의 역할을 수행 할 수도 있다.<br>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 844px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/32000ef09b80ea613a8ba2ecd863e11d/e9777/AWS_API_GATEWAY.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 42.89099526066351%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsSAAALEgHS3X78AAABsElEQVQoz42Qy27TQBiF/UYseQPEkg1CYokAiQVskVgieALEK4BQEWwpUECBxEmbUrfEsZ0gxb0kju3cHDuJb/HH2A1R0w0c6Wj+/8x/OTMSK2RZtj4vMl0xxzKJ13V/kaQZnh8TzJMily4PWC9gE9HMZ6DKzPpmUZckaaFvl3rcePCdh09/shS6xGUsl2SzOVkUFembzpgX+pBkZGMrJcbtw2JYGMbF2ncfTK7f+cq9J7ukwq20WCzwPA+r22Us4vHnL3Ru3iZ99pxXhsO1HZOP3em5S39CGs43vsgdhZTqAxRtUiyQHHdAJNwE3pR8Z/f1FvUrV/Hu3ufl4RmPD/p5N/8LKY5jYTUtmLcF5jG9rfcEP8q0RgG3vnV4JJ+QBR52c5dp/5RI9OQmEtEz6dlYjTaDzpnIE+HQcchp57Rt8YQRw3CB4/v4Q5ep62BaNseGivrpLS15B8uy6IkvskT9b6WBVqrR3lNwXBdJ13UuUtM0NFVFbzZp5rGm0zYMdBH/qldpKPsYRquoNVoGqnLEQbnK0d5+oUmVSoV/sbw65WoNWa5u3ssyck3o1XP9D9COkgp0NLsaAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n        <source\n          srcset=\"/static/32000ef09b80ea613a8ba2ecd863e11d/8ac56/AWS_API_GATEWAY.webp 240w,\n/static/32000ef09b80ea613a8ba2ecd863e11d/d3be9/AWS_API_GATEWAY.webp 480w,\n/static/32000ef09b80ea613a8ba2ecd863e11d/20d15/AWS_API_GATEWAY.webp 844w\"\n          sizes=\"(max-width: 844px) 100vw, 844px\"\n          type=\"image/webp\"\n        />\n        <source\n          srcset=\"/static/32000ef09b80ea613a8ba2ecd863e11d/e4891/AWS_API_GATEWAY.png 240w,\n/static/32000ef09b80ea613a8ba2ecd863e11d/0ce91/AWS_API_GATEWAY.png 480w,\n/static/32000ef09b80ea613a8ba2ecd863e11d/e9777/AWS_API_GATEWAY.png 844w\"\n          sizes=\"(max-width: 844px) 100vw, 844px\"\n          type=\"image/png\"\n        />\n        <img\n          class=\"gatsby-resp-image-image\"\n          src=\"/static/32000ef09b80ea613a8ba2ecd863e11d/e9777/AWS_API_GATEWAY.png\"\n          alt=\"AWS_API_GATEWAY\"\n          title=\"AWS_API_GATEWAY\"\n          loading=\"lazy\"\n          style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        />\n      </picture>\n  </a>\n    </span></p>\n<h3 id=\"api-게이트웨이-타입\"><a href=\"#api-%EA%B2%8C%EC%9D%B4%ED%8A%B8%EC%9B%A8%EC%9D%B4-%ED%83%80%EC%9E%85\" aria-label=\"api 게이트웨이 타입 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>API 게이트웨이 타입</h3>\n<p>아마존 API 게이트웨이에는 두가지 종류가 있다.</p>\n<ul>\n<li>REST API</li>\n<li>WebSocket API</li>\n</ul>\n<h3 id=\"api-게이트웨이의-기능들\"><a href=\"#api-%EA%B2%8C%EC%9D%B4%ED%8A%B8%EC%9B%A8%EC%9D%B4%EC%9D%98-%EA%B8%B0%EB%8A%A5%EB%93%A4\" aria-label=\"api 게이트웨이의 기능들 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>API 게이트웨이의 기능들</h3>\n<ul>\n<li>Serverless</li>\n<li>모니터링 기능을 제공</li>\n<li>인증</li>\n<li>쓰로틀링(throttling)</li>\n<li>Web Application Firewall(WAF)와 통합</li>\n<li>커스텀 도메인 네임 사용 가능</li>\n</ul>\n<h2 id=\"api-게이트웨이-환경설정\"><a href=\"#api-%EA%B2%8C%EC%9D%B4%ED%8A%B8%EC%9B%A8%EC%9D%B4-%ED%99%98%EA%B2%BD%EC%84%A4%EC%A0%95\" aria-label=\"api 게이트웨이 환경설정 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>API 게이트웨이 환경설정</h2>\n<h3 id=\"엔드포인트-타입\"><a href=\"#%EC%97%94%EB%93%9C%ED%8F%AC%EC%9D%B8%ED%8A%B8-%ED%83%80%EC%9E%85\" aria-label=\"엔드포인트 타입 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>엔드포인트 타입</h3>\n<p>API 게이트웨이를 사용하여 REST API를 만들 때 각 리소스가 어떤 람다 함수를 호출해야 하는지에 대한 정의뿐만 아니라 엔드포인트 타입도 같이 정의해야 한다.</p>\n<ul>\n<li>엔드포인트 타입은 API 당 설정을 해야 한다. (리소스나 메서드 당 설정 X)</li>\n<li>API 게이트웨이에는 3가지 엔드포인트 타입이 있다.</li>\n<li>이 중 2가지가 public 인데 <code class=\"language-text\">Edge optimized</code>와 <code class=\"language-text\">Regional</code>이 있다.</li>\n<li>이 중 다른 한가지는 private VPC인데 외부에서 접근이 불가능한 타입이다.</li>\n<li>만약 <code class=\"language-text\">Edge optimized</code> 엔드포인트 타입을 선택하고 API를 특정 지역(region)에 배포하면, AWS는 자동으로 CloudFront를 생성해준다. 그럼 모든 요청은 먼저 이 CloudFront를 거쳤다가 API 게이트웨이로 간다.</li>\n<li><code class=\"language-text\">Regional</code> 엔드포인트 타입은 사용자의 요청이 CloudFront를 거치지 않고 곧바로 API 게이트웨이로 간다.</li>\n</ul>\n<h3 id=\"lambda-integration-modes람다-통합-모드\"><a href=\"#lambda-integration-modes%EB%9E%8C%EB%8B%A4-%ED%86%B5%ED%95%A9-%EB%AA%A8%EB%93%9C\" aria-label=\"lambda integration modes람다 통합 모드 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Lambda Integration Modes(람다 통합 모드)</h3>\n<p>람다 함수를 배포하기 전에 고려해야 할 사항은 어떤 데이터 포맷이 API 게이트로부터 람다 함수에 전달되는지에 대한 것이다. 이 데이터 포맷은 어떤 통합 모드를 선택하는지에 따라 달렸다.\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 847px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/71b1df992fcdbdfaad3b4ec1230fa4ff/22cd6/Lambda_Integration_Modes.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 45.45454545454545%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsSAAALEgHS3X78AAAB4ElEQVQoz22Sy08TURSH+0+6NxIx4CNqTHRjXPjAmLhxY0NQCEajiZGNcSFFUQlqYICAQsGiFS0zHTrvd6e3n/dOsWrj3dzJ75z7O+d8Z0rdbpfBs9+0WNr6xkq1jh9EfT3LMnzfx7Is0jTtifJ9W3SphQnKqfQ7Oc/zwyTB+MxrHh0Z4s7wJSrru/24bdvo+zqGbqDrOnEco1zCKGS1vosQgpISdb2J4zhFkuvYlJ9WuHv8ImPnrjOrVQtDVSxJEsymWZiqfKXlsjv76ybOyhypY1JK0wzP8/l78PvP5jhx+zHDN6d583Gjb9jpdIiSFC8IieU71XU7l1rLwP6yRhY4f0Y+xNEznHnFmRuTjF6dYGG12o/HkeQZBfIjRAQuQhYYPH1DVb0tKyook9Lw9NgUo9fu8U7bopNnWK0WLbmgqW2ThztNHuyYWH4oEcnR44i2b6MWLBkm6EZTBtyCjSvBT0iGZ29Nc0p2Ob/0SXYWYJkmP2yfkQ8NLmgNzmsGDdsj8APM2meM5Qqpe6AYSiaeV2xIiN7M5ScvGboyztHLZWYX1xB5G0928tMJOLbwnZPv64ws7hWGURjhmw3sbY3MswYZ9gw3a3s8n1/mxVsN48D5Jx7LJSS5KO7//cO/AE5ClSOBLt1nAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n        <source\n          srcset=\"/static/71b1df992fcdbdfaad3b4ec1230fa4ff/8ac56/Lambda_Integration_Modes.webp 240w,\n/static/71b1df992fcdbdfaad3b4ec1230fa4ff/d3be9/Lambda_Integration_Modes.webp 480w,\n/static/71b1df992fcdbdfaad3b4ec1230fa4ff/8a8c4/Lambda_Integration_Modes.webp 847w\"\n          sizes=\"(max-width: 847px) 100vw, 847px\"\n          type=\"image/webp\"\n        />\n        <source\n          srcset=\"/static/71b1df992fcdbdfaad3b4ec1230fa4ff/e4891/Lambda_Integration_Modes.png 240w,\n/static/71b1df992fcdbdfaad3b4ec1230fa4ff/0ce91/Lambda_Integration_Modes.png 480w,\n/static/71b1df992fcdbdfaad3b4ec1230fa4ff/22cd6/Lambda_Integration_Modes.png 847w\"\n          sizes=\"(max-width: 847px) 100vw, 847px\"\n          type=\"image/png\"\n        />\n        <img\n          class=\"gatsby-resp-image-image\"\n          src=\"/static/71b1df992fcdbdfaad3b4ec1230fa4ff/22cd6/Lambda_Integration_Modes.png\"\n          alt=\"Lambda_Integration_Modes\"\n          title=\"Lambda_Integration_Modes\"\n          loading=\"lazy\"\n          style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        />\n      </picture>\n  </a>\n    </span>\n두가지 통합 모드가 있다.</p>\n<ul>\n<li>Proxy: 모든 요청 정보를 람다 함수로 전달한다. 사용하기 쉬움</li>\n<li>Non-proxy: 사용자로부터 들어오는 요청을 <code class=\"language-text\">Velocity Template Language</code>를 사용하여 변환하여 전달한다.</li>\n</ul>\n<h2 id=\"api-게이트웨이-스테이지\"><a href=\"#api-%EA%B2%8C%EC%9D%B4%ED%8A%B8%EC%9B%A8%EC%9D%B4-%EC%8A%A4%ED%85%8C%EC%9D%B4%EC%A7%80\" aria-label=\"api 게이트웨이 스테이지 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>API 게이트웨이 스테이지</h2>\n<p>API 게이트웨이 스테이지는 구현된 REST API의 라이프사이클 상태에 대한 논리적 참조이다.\n(API Gateway Stage is a logical reference to a lifecycle state of the REST API implementation.)</p>\n<p>예를들어, REST API에는 여러가지 스테이지가 있을 수 있는데 개발자들이 사용하는 dev 스테이지가 있을 수 있고, 배포 전에 테스트를 위한 staging 스테이지가 있을 수 있고, 실제 사용자들이 사용하는 prod 스테이지가 있을 수 있다.</p>\n<p>각 스테이지들은 아래의 그림처럼 서로 다른 URL을 가진다. 중요한 점은 각 스테이지들은 서로 다른 람다 함수 버전을 사용한다는 것이다.\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 808px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/c6eaadbafaddd5c5fcd58b7228f5065f/38b39/API_GATEWAY_STAGES.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 46.90594059405941%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsSAAALEgHS3X78AAABgElEQVQoz3VSPUvDUBQNuAtOzk5uDv4SF0dnQVwER0dFFLq5dBCcFBxUFGdHESoKNba0WO1H2lhjk+arL8lLjve92jYpeuHkXm4u557DfUqSJBAhskAcx0j3NMPER7eHOqHvekjHaC5dK7L4xYRoONS0PMydqZg9L0M5ecHOo0bdCIwnsLttmLUiGAsIbEyqyIIQpzZzUsnDEDYLka9aOCIclnp4MAZymscJQuaDWQY45xIZQlfX4WqabEZRhJDIJLGoHRvMdcA9Z5h5jL9iYpnU1NY30VhZhWuaCIhMEsYcjZ6NxcsSFq4qmDl9xd4TLU1CBCPL7yrNTwRIheLTyh9DO8ghGAwQkqqRBSeIsK8a2FW/sf38hTvdG1omMaHvwjc6UrE4ZMZyOsRPsTESpAkNu30EtkXZBvc9/BeZK0tkngskWct0sHxTwdLtG+YvqsgVdeqLK8dwSJ1VL9PyacupN4ipus8ibBU62CjoWLtv47ppjy0Hng33s0lHzF75B1REqiGZkUH/AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n        <source\n          srcset=\"/static/c6eaadbafaddd5c5fcd58b7228f5065f/8ac56/API_GATEWAY_STAGES.webp 240w,\n/static/c6eaadbafaddd5c5fcd58b7228f5065f/d3be9/API_GATEWAY_STAGES.webp 480w,\n/static/c6eaadbafaddd5c5fcd58b7228f5065f/2b269/API_GATEWAY_STAGES.webp 808w\"\n          sizes=\"(max-width: 808px) 100vw, 808px\"\n          type=\"image/webp\"\n        />\n        <source\n          srcset=\"/static/c6eaadbafaddd5c5fcd58b7228f5065f/e4891/API_GATEWAY_STAGES.png 240w,\n/static/c6eaadbafaddd5c5fcd58b7228f5065f/0ce91/API_GATEWAY_STAGES.png 480w,\n/static/c6eaadbafaddd5c5fcd58b7228f5065f/38b39/API_GATEWAY_STAGES.png 808w\"\n          sizes=\"(max-width: 808px) 100vw, 808px\"\n          type=\"image/png\"\n        />\n        <img\n          class=\"gatsby-resp-image-image\"\n          src=\"/static/c6eaadbafaddd5c5fcd58b7228f5065f/38b39/API_GATEWAY_STAGES.png\"\n          alt=\"API_GATEWAY_STAGES\"\n          title=\"API_GATEWAY_STAGES\"\n          loading=\"lazy\"\n          style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        />\n      </picture>\n  </a>\n    </span></p>\n<h2 id=\"dynamodb-with-nodejs\"><a href=\"#dynamodb-with-nodejs\" aria-label=\"dynamodb with nodejs permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>DynamoDB with Node.js</h2>\n<ul>\n<li>AWS는 두 개의 DynamoDB 클라이언트를 제공한다.</li>\n<li>AWS.DynamoDB는 로우레벨 클라이언트이다.</li>\n<li>AWS.DynamoDB.DocumentClient는 하이레벨 클라이언트이다.</li>\n</ul>\n<p>Nodejs에서 DynamoDB를 사용하기 위해서는 먼저 DynamoDB 인스턴스를 만들어야한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> docClient <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">AWS<span class=\"token punctuation\">.</span>DynamoDB<span class=\"token punctuation\">.</span>DocumentClient</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">...</span>\n<span class=\"token comment\">// 콜백 패턴</span>\ndocClient<span class=\"token punctuation\">.</span><span class=\"token function\">scan</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  TableName<span class=\"token punctuation\">:</span> <span class=\"token string\">\"Users\"</span><span class=\"token punctuation\">,</span>\n  Limit<span class=\"token punctuation\">:</span> <span class=\"token number\">20</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">err<span class=\"token punctuation\">,</span> data</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">//Process data or error</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">// 프로미스 패턴</span>\n<span class=\"token keyword\">const</span> result <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> docClient<span class=\"token punctuation\">.</span><span class=\"token function\">scan</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  TableName<span class=\"token punctuation\">:</span> <span class=\"token string\">\"Users\"</span><span class=\"token punctuation\">,</span>\n  Limit<span class=\"token punctuation\">:</span> <span class=\"token number\">20</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">promise</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h1 id=\"serverless-프레임워크\"><a href=\"#serverless-%ED%94%84%EB%A0%88%EC%9E%84%EC%9B%8C%ED%81%AC\" aria-label=\"serverless 프레임워크 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Serverless 프레임워크</h1>\n<p>서버리스 어플리케이션을 배포하기 위해 필요한 것들은 다음과 같다. <code class=\"language-text\">AWS Console</code>을 사용하여 모든것을 하나씩 일일이 하는 것은 큰 소요가 든다. 서버리스 프레임워크를 사용하면 이 모든것을 간단히 해결할 수 있다.</p>\n<ul>\n<li>람다 함수</li>\n<li>API 게이트웨이 설정</li>\n<li>여러가지 다른 자원들 준비(DB, S3 버켓, IAM 정책 등)</li>\n<li>위의 모든 것들 연결</li>\n<li>코드 패키징</li>\n<li>배포</li>\n</ul>\n<h2 id=\"서버리스-프레임워크-소개\"><a href=\"#%EC%84%9C%EB%B2%84%EB%A6%AC%EC%8A%A4-%ED%94%84%EB%A0%88%EC%9E%84%EC%9B%8C%ED%81%AC-%EC%86%8C%EA%B0%9C\" aria-label=\"서버리스 프레임워크 소개 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>서버리스 프레임워크 소개</h2>\n<ul>\n<li>어플리케이션을 배포하는 표준화된 방법</li>\n<li>필요한 자원들을 생성해줌</li>\n<li>\n<p>어플리케이션을 관리해줌</p>\n<ul>\n<li>어플리케이션 제거, 함수 호출, 어플리케이션 로컬에서 실행 등</li>\n</ul>\n</li>\n</ul>\n<p>서버리스 프레임워크 종류는 여러가지가 있다.</p>\n<ul>\n<li>서버리스 프레임워크</li>\n<li>Zappa (python only)</li>\n<li>Serverless Application Model(SAM)</li>\n</ul>\n<p>이 중 이 수업에서는 첫번째인 서버리스 프레임워크를 사용한다. 서버리스 프레임워크는 이중 가장 유명하고 여러개의 플러그인을 사용할 수 있고 큰 커뮤니티가 있다.</p>\n<p>서버리스 프레임워크는 다음의 클라우드 프로바이더들과 함께 사용할 수 있다.</p>\n<ul>\n<li>AWS</li>\n<li>Microsoft Azure</li>\n<li>Google Cloud Platform</li>\n<li>Kubeless</li>\n<li>IBM OpenWhisk</li>\n<li>ETC</li>\n</ul>\n<h2 id=\"yaml\"><a href=\"#yaml\" aria-label=\"yaml permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>YAML</h2>\n<ul>\n<li>서버리스 프레임워크의 환경설정은 YAML 포맷으로 구성된다.</li>\n<li>YAML 포맷은 흔한 환경설정 파일 포맷이다.</li>\n<li>\n<p>JSON의 수퍼셋이다.</p>\n<ul>\n<li>유효한 JSON 파일은 유효한 YAML 파일이다.</li>\n<li>YAML은 추가적인 기능을 제공한다.</li>\n<li>YAML은 JSON보다 더 간결한 포맷이다.</li>\n</ul>\n</li>\n<li>스페이스로 인덴테이션을 구분한다. (JSON에서는 컬리 브라켓으로 구분)</li>\n</ul>\n<h3 id=\"yaml-format-vs-json-format\"><a href=\"#yaml-format-vs-json-format\" aria-label=\"yaml format vs json format permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>YAML Format vs JSON Format</h3>\n<p>다음에서 YAML 포맷과 JSON 포맷의 비교한 것을 확인해볼 수 있다. 두 파일은 동일한 의미를 나타낸다.</p>\n<p>YAML Format</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token comment\"># YAML 파일에서는 주석을 달 수 있다.</span>\n\n<span class=\"token comment\"># 키와 값에 string quotation 을 달지 않아도 된다.</span>\n<span class=\"token key atrule\">key</span><span class=\"token punctuation\">:</span> value\n\n<span class=\"token comment\"># Yaml 에서는 배열을 다음과 같이도 표현할 수 있다.</span>\n<span class=\"token key atrule\">array</span><span class=\"token punctuation\">:</span>\n  <span class=\"token punctuation\">-</span> <span class=\"token number\">1</span>\n  <span class=\"token punctuation\">-</span> <span class=\"token number\">2</span>\n\n<span class=\"token key atrule\">objects</span><span class=\"token punctuation\">:</span>\n  <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Jack\n    <span class=\"token key atrule\">suname</span><span class=\"token punctuation\">:</span> Brown\n  <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Joe</code></pre></div>\n<p>JSON Format</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"key\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"value\"</span><span class=\"token punctuation\">,</span>\n\n  <span class=\"token property\">\"array\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n\n  <span class=\"token property\">\"objects\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Jack\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"surname\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Brown\"</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Joe\"</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>YAML Format</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">complex</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">nested</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">key1</span><span class=\"token punctuation\">:</span> value1\n    <span class=\"token key atrule\">key2</span><span class=\"token punctuation\">:</span> value2\n  <span class=\"token key atrule\">anotherNested</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">key</span><span class=\"token punctuation\">:</span> value</code></pre></div>\n<p>JSON Format</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"complex\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"nested\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"key1\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"value1\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"key2\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"value2\"</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"anotherNested\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"key\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"value\"</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3 id=\"serverless-프레임워크-컨셉\"><a href=\"#serverless-%ED%94%84%EB%A0%88%EC%9E%84%EC%9B%8C%ED%81%AC-%EC%BB%A8%EC%85%89\" aria-label=\"serverless 프레임워크 컨셉 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Serverless 프레임워크 컨셉</h3>\n<p>서버리스 프레임워크를 사용하여 어플리케이션을 만들려면 다음의 컴포넌트들을 사용해야 한다. 이 모든 것들을 조합하여 하나의 서비리스 어플리케이션을 만들 수 있다.\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 853px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/05da8311cd88edb31db1cdb4550e1e46/3eaa1/serverless_framework_concept.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 45.72098475967175%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsSAAALEgHS3X78AAABrElEQVQoz21STW/TQBD1Ge6o0D8AvwWOqXruL+n/qMSVAxygSEGcKqRUQoBUcUFIDYpR46ydOLHjXdu73g8/ZjdxSwUrPXv3zZs341lHoKXbGoLFcNYgrL6HcT1Etka35TvOOWhtkG8adJ3X9YEWRmH87QvmcxbOkX/YpkL58ytgNPaOlGTByxpaDRyIc/j+Y4lGDoUppTc4ffUeF1fXO0MpJTabDfI8D29rbQiUZYk0W4ILsTfrwBhDmuZYLldQSgWebyvcJClWRRkqRG3bBiFjKbIsuzX05oskQVVV4ewN5jdz0qRIiPeN+FVQ4Xg2w5oa6mlUkTEGDZlKqcKMdskdOOfotB5GGvYVcb7joTtNuVXFIUSNdl8gwn+WIyHfbml+6i/SQTZNiN1xFm1NBaihgY8sCVvqbIA0FkJ2KLjAmm64oRuttQ1Q1oX4Tucg6EtK0UDRH9ES772il9MCD15PcXge4+DtDAfvPGI8Pvf4Hc7PxjGeEh75+K3mTveE9g/f/MLZdYHo44Lj+acEx5cMR5cLHE3uY0Q4+cwCRpN/4x7HlPeCPD4kHH8AOhKRYxx1wnQAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n        <source\n          srcset=\"/static/05da8311cd88edb31db1cdb4550e1e46/8ac56/serverless_framework_concept.webp 240w,\n/static/05da8311cd88edb31db1cdb4550e1e46/d3be9/serverless_framework_concept.webp 480w,\n/static/05da8311cd88edb31db1cdb4550e1e46/d8b1f/serverless_framework_concept.webp 853w\"\n          sizes=\"(max-width: 853px) 100vw, 853px\"\n          type=\"image/webp\"\n        />\n        <source\n          srcset=\"/static/05da8311cd88edb31db1cdb4550e1e46/e4891/serverless_framework_concept.png 240w,\n/static/05da8311cd88edb31db1cdb4550e1e46/0ce91/serverless_framework_concept.png 480w,\n/static/05da8311cd88edb31db1cdb4550e1e46/3eaa1/serverless_framework_concept.png 853w\"\n          sizes=\"(max-width: 853px) 100vw, 853px\"\n          type=\"image/png\"\n        />\n        <img\n          class=\"gatsby-resp-image-image\"\n          src=\"/static/05da8311cd88edb31db1cdb4550e1e46/3eaa1/serverless_framework_concept.png\"\n          alt=\"serverless_framework_concept\"\n          title=\"serverless_framework_concept\"\n          loading=\"lazy\"\n          style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        />\n      </picture>\n  </a>\n    </span></p>\n<h3 id=\"serverless-프로젝트-구조\"><a href=\"#serverless-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8-%EA%B5%AC%EC%A1%B0\" aria-label=\"serverless 프로젝트 구조 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Serverless 프로젝트 구조</h3>\n<p>/node_modules</p>\n<ul>\n<li>plugins, prod. and dev. dependencies\n/src</li>\n<li>function.js\nserverless.yml</li>\n</ul>\n<p>package.json</p>\n<p>package-lock.json</p>\n<h2 id=\"serverless-프레임워크-어플리케이션\"><a href=\"#serverless-%ED%94%84%EB%A0%88%EC%9E%84%EC%9B%8C%ED%81%AC-%EC%96%B4%ED%94%8C%EB%A6%AC%EC%BC%80%EC%9D%B4%EC%85%98\" aria-label=\"serverless 프레임워크 어플리케이션 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Serverless 프레임워크 어플리케이션</h2>\n<h3 id=\"serverlessyml-파일-구조\"><a href=\"#serverlessyml-%ED%8C%8C%EC%9D%BC-%EA%B5%AC%EC%A1%B0\" aria-label=\"serverlessyml 파일 구조 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Serverless.yml 파일 구조</h3>\n<ul>\n<li>Provider - 프로파이더 특정 설정</li>\n<li>Functions - 서비스에서 사용할 함수</li>\n<li>Plugins - 서버리스 프레임워크를 확장할 플러그인</li>\n<li>Resources - 추가적인 클라우드 리소스</li>\n</ul>\n<h3 id=\"serverlessyml---provider-환경설정\"><a href=\"#serverlessyml---provider-%ED%99%98%EA%B2%BD%EC%84%A4%EC%A0%95\" aria-label=\"serverlessyml   provider 환경설정 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Serverless.yml - Provider 환경설정</h3>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">service</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> serverless<span class=\"token punctuation\">-</span>app\n\n<span class=\"token key atrule\">provider</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> aws\n  <span class=\"token key atrule\">runtime</span><span class=\"token punctuation\">:</span> nodejs8.10\n  <span class=\"token key atrule\">region</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'us-east-1'</span>\n  <span class=\"token comment\"># 환경변수 적용, 모든 함수에서 여기에 정의하는 환경변수를 사용할 수 있음</span>\n  <span class=\"token key atrule\">environment</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">GROUPS_TABLE</span><span class=\"token punctuation\">:</span> Groups</code></pre></div>\n<h3 id=\"serverlessyml---리소스와-플러그인\"><a href=\"#serverlessyml---%EB%A6%AC%EC%86%8C%EC%8A%A4%EC%99%80-%ED%94%8C%EB%9F%AC%EA%B7%B8%EC%9D%B8\" aria-label=\"serverlessyml   리소스와 플러그인 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Serverless.yml - 리소스와 플러그인</h3>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">plugins</span><span class=\"token punctuation\">:</span>\n  <span class=\"token punctuation\">-</span> serverless<span class=\"token punctuation\">-</span>webpack\n\n<span class=\"token key atrule\">resources</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">Resources</span><span class=\"token punctuation\">:</span>\n    <span class=\"token comment\"># CloudFormation 정의 YAML 파일</span></code></pre></div>\n<p>서버리스 프레임워크는 여러개의 플러그인을 사용하여 기능을 확장할 수 있다. 이 수업에서는 몇가지 유명한 플러그인을 사용할 예정이다.</p>\n<ul>\n<li>프로젝트를 위해 사용할 플러그인들은 <a href=\"https://www.serverless.com/plugins/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">플러그인 카탈로그</a> 에서 확인해볼 수 있다.</li>\n<li>만약 필요한 플러그인을 찾지 못했다면, 나만의 플러그인을 직접 만들 수도 있다.</li>\n</ul>\n<h3 id=\"serverlessyml---함수-환경설정\"><a href=\"#serverlessyml---%ED%95%A8%EC%88%98-%ED%99%98%EA%B2%BD%EC%84%A4%EC%A0%95\" aria-label=\"serverlessyml   함수 환경설정 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Serverless.yml - 함수 환경설정</h3>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">functions</span><span class=\"token punctuation\">:</span>\n  <span class=\"token comment\"># 람다 함수 이름</span>\n  <span class=\"token key atrule\">GetOrders</span><span class=\"token punctuation\">:</span>\n    <span class=\"token comment\"># src/orders까지는 파일 경로이다. handler는 자바스크립트 함수 이름이다.</span>\n    <span class=\"token key atrule\">handler</span><span class=\"token punctuation\">:</span> src/orders.handler\n    <span class=\"token comment\"># 위의 함수를 실행시키는 이벤트를 정의한다.</span>\n    <span class=\"token key atrule\">events</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">http</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">method</span><span class=\"token punctuation\">:</span> get\n        <span class=\"token key atrule\">path</span><span class=\"token punctuation\">:</span> /shop/orders</code></pre></div>\n<h3 id=\"지원되는-이벤트\"><a href=\"#%EC%A7%80%EC%9B%90%EB%90%98%EB%8A%94-%EC%9D%B4%EB%B2%A4%ED%8A%B8\" aria-label=\"지원되는 이벤트 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>지원되는 이벤트</h3>\n<p>서버리스 프레임워크에는 여러가지 이벤트가 지원된다.</p>\n<ul>\n<li>API 게이트웨이 - REST/WebSocket API</li>\n<li>SQS - Simple Queue Service</li>\n<li>Alexa</li>\n<li>CloudWatch Events - 스케줄링 이벤트</li>\n<li>CloudWatch Logs - 프로세스 로그 이벤트</li>\n<li>SNS - Simple Notification Service</li>\n<li>ETC</li>\n</ul>\n<p>더 많은 이벤트들에 대해 알고 싶다면 <a href=\"https://www.serverless.com/framework/docs/providers/aws/events/apigateway/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">여기서</a> 서버리스 프레임워크가 지원하는 모든 이벤트의 목록을 확인해볼 수 있다.</p>\n<h3 id=\"서버리스-프레임워크가-하는-일\"><a href=\"#%EC%84%9C%EB%B2%84%EB%A6%AC%EC%8A%A4-%ED%94%84%EB%A0%88%EC%9E%84%EC%9B%8C%ED%81%AC%EA%B0%80-%ED%95%98%EB%8A%94-%EC%9D%BC\" aria-label=\"서버리스 프레임워크가 하는 일 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>서버리스 프레임워크가 하는 일</h3>\n<p>서버리스 프레임워크는 개발자가 정의한 <code class=\"language-text\">Serverless.yml</code> 파일을 사용하여 <code class=\"language-text\">CloudFormation 템플릿</code>을 만든다. 이 템플릿은 AWS에서 CloudFormation 서비스를 사용하기 위한 템플릿이다. 이를 사용하여 CloudFormation 서비스에 배포하면 AWS ClodFormation 은 이 어플리케이션과 어플리케이션이 구동하기 위한 인프라스트럭쳐를 만들고 업데이트 한다. 따라서 서버리스 프레임워크를 사용하는 방법을 이해하기 위해서는 먼저 CloudFormation 을 사용하는 방법과 CloudFormation 템플릿을 작성하는 방법을 알아야 한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 926px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/d4308a5b473d54410b73fd4f2abfa820/8923f/Serverless_Framwork_nutshell.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 30.6695464362851%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsSAAALEgHS3X78AAABZ0lEQVQY012PuUoDURSGry8g6OtYWImljTaC+ghioYWpLKzcEFzAKLhEEQWt3RKDKO4WbklciCaZZCRoZiazMSafd+KCeuDjP5zzn3PuFZrrkShY3Bds4m8WqunyHaVSmULW4TUjSTsUci5lWfuO91cNL6XipV8qWrJsRM+5igglqF1/RCzfU7f5hGXaFB2D5KVGsCXDXEeW2XaFmVaFdNxAs3R0zcDsHMVpCmC39eM2dmOHNhDzD2/Ub6do3svQEEkTuFD9t/n3cRSXSF+eg6E8+4N5ov15vBf/B560SCbXIDAFA0vQPU45fIZIFV22Mzq7WaNCNGcQyRV/2MrqbMn+psTPw7K2mzMrvbBqsiNnIorOhmLwbHmIrsMUIniFWLhBzP1i9pqqxVtqVmJUS2pWY9RKFaHP3h/vwi1i+oreY7krHEsyfBhn/DjB2D8mT+4Int4x9aU+EzL/4ztKVGZH5I5oPMkHbaCLlAKMhicAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n        <source\n          srcset=\"/static/d4308a5b473d54410b73fd4f2abfa820/8ac56/Serverless_Framwork_nutshell.webp 240w,\n/static/d4308a5b473d54410b73fd4f2abfa820/d3be9/Serverless_Framwork_nutshell.webp 480w,\n/static/d4308a5b473d54410b73fd4f2abfa820/dafe9/Serverless_Framwork_nutshell.webp 926w\"\n          sizes=\"(max-width: 926px) 100vw, 926px\"\n          type=\"image/webp\"\n        />\n        <source\n          srcset=\"/static/d4308a5b473d54410b73fd4f2abfa820/e4891/Serverless_Framwork_nutshell.png 240w,\n/static/d4308a5b473d54410b73fd4f2abfa820/0ce91/Serverless_Framwork_nutshell.png 480w,\n/static/d4308a5b473d54410b73fd4f2abfa820/8923f/Serverless_Framwork_nutshell.png 926w\"\n          sizes=\"(max-width: 926px) 100vw, 926px\"\n          type=\"image/png\"\n        />\n        <img\n          class=\"gatsby-resp-image-image\"\n          src=\"/static/d4308a5b473d54410b73fd4f2abfa820/8923f/Serverless_Framwork_nutshell.png\"\n          alt=\"Serverless_Framwork_nutshell\"\n          title=\"Serverless_Framwork_nutshell\"\n          loading=\"lazy\"\n          style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        />\n      </picture>\n  </a>\n    </span></p>\n<h2 id=\"cloudformation\"><a href=\"#cloudformation\" aria-label=\"cloudformation permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>CloudFormation</h2>\n<ul>\n<li>AWS 리소스들을 만들고 관리할 수 있는 서비스이다.</li>\n<li>\n<p>선언적이다.(Declarative) (인프라스트럭쳐를 어떻게 업데이트하고 싶은지에 대한 정의를 할 필요가 없다. 만들고 싶은 최종 상태(end state)만 정의해주면 된다. ??)</p>\n<ul>\n<li>YAML/JSON 설정 파일을 작성한다.</li>\n<li>CloudFormation 이 이 파일을 읽고 AWS 리소스들의 상태를 업데이트한다.</li>\n<li>인프라스트럭쳐를 Version Control 할 수 있다.</li>\n</ul>\n</li>\n<li>\n<p>무료 서비스이다.</p>\n<ul>\n<li>CloudFormation을 통해 생성되는 리소스들에 대한 비용만 지불하면 된다.</li>\n</ul>\n</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 843px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/00603e174152ffd605bd4b7508f0312e/d619d/CloudFormation_process.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 45.90747330960854%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsSAAALEgHS3X78AAABh0lEQVQoz51Qy07CUBDt77hz5S/4B65c+AV8iGvjyp1xpws3JG6AICTSkjZBoaUQHi1iaeVNS9/HuaWBijtvcjKvc2bmDhfHMaIU7LE4QepHQUgIEEcRjt+em9Fyx4RD8EePKAwR0ICQ7C9uok0bhlGM7sKGttokhYDIruuC7eOOLWh3z+jfPsJWNTiBB7nZgmVZCXe79bFebRFFmQ0dmnjT6OFBGSKmZovFEtpgiLXnwigIKJ9doXhyAe0+j2XgoqOoMAwD9saB3P6C9DGiAavdD+gsnEGFXJHHtdCERw2TSem9ZnwTb+c5vJ5eYvxU2InYTanOtukPviG967Bt77DhxnFQajTBt7vwfJ9uFMAnG5LI0seQX8po5Uv4VHsIScBqfsqbz+cY6SN4rrfPc+weU3OSgPmmacIka5GdMMymmMynMFiewDjsy3JLRqVSQbVShSRK0HU9qXGqqkLtdHZgfgYdhnaKTF5RFLSooSiKEAQBsiwnYDWO53n8F6xZvV7fx7VaDT9wZ5jnYHs1nwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n        <source\n          srcset=\"/static/00603e174152ffd605bd4b7508f0312e/8ac56/CloudFormation_process.webp 240w,\n/static/00603e174152ffd605bd4b7508f0312e/d3be9/CloudFormation_process.webp 480w,\n/static/00603e174152ffd605bd4b7508f0312e/e3019/CloudFormation_process.webp 843w\"\n          sizes=\"(max-width: 843px) 100vw, 843px\"\n          type=\"image/webp\"\n        />\n        <source\n          srcset=\"/static/00603e174152ffd605bd4b7508f0312e/e4891/CloudFormation_process.png 240w,\n/static/00603e174152ffd605bd4b7508f0312e/0ce91/CloudFormation_process.png 480w,\n/static/00603e174152ffd605bd4b7508f0312e/d619d/CloudFormation_process.png 843w\"\n          sizes=\"(max-width: 843px) 100vw, 843px\"\n          type=\"image/png\"\n        />\n        <img\n          class=\"gatsby-resp-image-image\"\n          src=\"/static/00603e174152ffd605bd4b7508f0312e/d619d/CloudFormation_process.png\"\n          alt=\"CloudFormation_process\"\n          title=\"CloudFormation_process\"\n          loading=\"lazy\"\n          style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        />\n      </picture>\n  </a>\n    </span></p>\n<h3 id=\"cloudformation-템플릿을-사용하여-정의\"><a href=\"#cloudformation-%ED%85%9C%ED%94%8C%EB%A6%BF%EC%9D%84-%EC%82%AC%EC%9A%A9%ED%95%98%EC%97%AC-%EC%A0%95%EC%9D%98\" aria-label=\"cloudformation 템플릿을 사용하여 정의 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>CloudFormation 템플릿을 사용하여 정의</h3>\n<p>CloudFormation 템플릿을 사용하여 다음이 것들을 정의할 수 있다. 이 수업에서는 이 중 <code class=\"language-text\">Resources</code>만 사용한다.</p>\n<ul>\n<li>Parameters - 어플리케이션의 실행에 대한 환경설정</li>\n<li>Resources - 만들고 싶은 리소스들의 목록</li>\n<li>Conditions - 특정 리소스를 언제 생성할지에 대한 정의</li>\n<li>Output - CloudFormation 템플릿 실행후 어떤 값들이 응답으로 반환되어야 하는지에 대한 정의</li>\n</ul>\n<h3 id=\"cloudformation-리소스-정의\"><a href=\"#cloudformation-%EB%A6%AC%EC%86%8C%EC%8A%A4-%EC%A0%95%EC%9D%98\" aria-label=\"cloudformation 리소스 정의 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>CloudFormation 리소스 정의</h3>\n<p>다음은 CloudFormation을 활용하여 AWS DynamoDB 리소스를 정의하는 예시이다. 다음 그림처럼 AWS DynamoDB의 GUI를 활용하여 테이블을 정의할 수 있지만 CloudFormation 을 활용하면 다음의 Yaml 파일에서도 정의할 수 있다.\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 846px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/db5e324e783586096f431e332694df55/7a2f6/CloudFormation_resources.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 46.21749408983451%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsSAAALEgHS3X78AAABbklEQVQoz11Si1LDMAzb/38jx4BudE3TpI+kbfoSUmA9wHc+9+HIkpzLuq7Ytg3HceB36P2ZihgjvPNwjcMwDFiWBSmlnMIIQ8jfL33XsdEhhph/6qDq/+j7HtfrFUVxQ21q2LpB0zTo2i6nzs/zjIuaO4Lamk1sdNaiYUZOCyFgmqaTZZoT+q7P9diP/G/f9z+DM2AYJ7yXFW5VDR9HuDAipCVLUSpa33KozdI0aBzHzEqp54kY6s2A47qhoITrZ4W3UmnwoF+RoM8QkCTqsADl++k12e7bntlmwIUPami9z5LrqsJAG8I0Y/9ZzHMJnkxrY2GtssnVGJOHnJITwTp6I++GfsBMoHVdMC/r6ZGkaWBFn4NkcnmqA5lrYSOtOhkm0o0EKSuDmlNVWw4IiVfqZyH6/vL6jo/ijuL+wJ3WGPZpSfJXi5XKbw/JpGp73Di9oJyHa1Fah7LxMLx3YqrmxDrTV+e7zOzp4+/4AmUMuEh+DlviAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n        <source\n          srcset=\"/static/db5e324e783586096f431e332694df55/8ac56/CloudFormation_resources.webp 240w,\n/static/db5e324e783586096f431e332694df55/d3be9/CloudFormation_resources.webp 480w,\n/static/db5e324e783586096f431e332694df55/47c32/CloudFormation_resources.webp 846w\"\n          sizes=\"(max-width: 846px) 100vw, 846px\"\n          type=\"image/webp\"\n        />\n        <source\n          srcset=\"/static/db5e324e783586096f431e332694df55/e4891/CloudFormation_resources.png 240w,\n/static/db5e324e783586096f431e332694df55/0ce91/CloudFormation_resources.png 480w,\n/static/db5e324e783586096f431e332694df55/7a2f6/CloudFormation_resources.png 846w\"\n          sizes=\"(max-width: 846px) 100vw, 846px\"\n          type=\"image/png\"\n        />\n        <img\n          class=\"gatsby-resp-image-image\"\n          src=\"/static/db5e324e783586096f431e332694df55/7a2f6/CloudFormation_resources.png\"\n          alt=\"CloudFormation_resources\"\n          title=\"CloudFormation_resources\"\n          loading=\"lazy\"\n          style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        />\n      </picture>\n  </a>\n    </span>\nCloudFormation Template</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">Resources</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">GroupsDynamoDBTable</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">Type</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'AWS::DynamoDB::Table'</span>\n    <span class=\"token key atrule\">Properties</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">TableName</span><span class=\"token punctuation\">:</span> Group\n      <span class=\"token key atrule\">AttributeDefinitions</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">AttributeName</span><span class=\"token punctuation\">:</span> id\n          <span class=\"token key atrule\">AttributeType</span><span class=\"token punctuation\">:</span> S\n      <span class=\"token key atrule\">KeySchema</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">AttributeName</span><span class=\"token punctuation\">:</span> id\n          <span class=\"token key atrule\">KeyType</span><span class=\"token punctuation\">:</span> HASH\n      <span class=\"token key atrule\">BillingMode</span><span class=\"token punctuation\">:</span> PAY_PER_REQUEST</code></pre></div>\n<p>DynamoDB 용어</p>\n<ul>\n<li>Partition key - 과거에는 이름이 Hash Key 였음</li>\n<li>Sort key - 과거에는 이름이 Range Key 였음</li>\n<li>옛날 용어들이 아직 라이브러리와 CloudFormation에서 사용되고 있음</li>\n</ul>\n<p>대부분은 AWS 리소스는 CloudFormation을 활용하여 생성될 수 있지만 가끔 흔하지는 않은 경우이지만 CloudFormation이 지원하지 않는 AWS 리소스가 있을 수 있다. 이때는 AWS API, AWS CLI, AWS 대시보드 등을 통해 생성해야 한다.</p>\n<p><a href=\"https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-template-resource-type-ref.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">CloudFormation 리소스 레퍼런스</a> 참고</p>\n<h2 id=\"serverless-프레임워크-사용하기\"><a href=\"#serverless-%ED%94%84%EB%A0%88%EC%9E%84%EC%9B%8C%ED%81%AC-%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0\" aria-label=\"serverless 프레임워크 사용하기 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Serverless 프레임워크 사용하기</h2>\n<p>설치</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">npm install -g serverless</code></pre></div>\n<p>프로젝트 만들기</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">serverless create --template aws-nodejs-typescript --path folder-name</code></pre></div>\n<p>플러그인 설치</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">npm install plugin-name --save-dev</code></pre></div>\n<p>프로젝트 배포</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">sls deploy -v</code></pre></div>\n<h2 id=\"serverless-프로젝트-만들기-데모\"><a href=\"#serverless-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8-%EB%A7%8C%EB%93%A4%EA%B8%B0-%EB%8D%B0%EB%AA%A8\" aria-label=\"serverless 프로젝트 만들기 데모 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Serverless 프로젝트 만들기 데모</h2>\n<ol>\n<li>Serverless 설치</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">npm install -g serverless</code></pre></div>\n<ol start=\"2\">\n<li>IAM에 새로운 사용자 이름을 <code class=\"language-text\">serverless</code>로 셋업 후 엑세스키와 시크릿키 저장</li>\n<li>Serverless에서 2번에서 설정한 AWS 사용자를 사용할 수 있도록 환경설정하기</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">sls config credentials --provider aws --key YOUR_ACCESS_KEY --secret YOUR_SECRET_KEY --profile serverless</code></pre></div>\n<p>사용 가능한 serverless 템플릿 목록 확인</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">sls create --template</code></pre></div>\n<p>serverless 보일러플레이트 프로젝트 만들기</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">sls create --template aws-nodejs-typescript --path project-name</code></pre></div>\n<p>어플리케이션 배포하기</p>\n<ol>\n<li>디펜던시 설치</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">npm install</code></pre></div>\n<ol start=\"2\">\n<li>배포하기</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">sls deploy -v</code></pre></div>\n<p>위의 배포하기 명령어를 실행시 나오는 로그는 다음과 같다. 로그를 읽어보면 먼저 zip 파일로 프로젝트를 패키징하고 CloudFormation을 통해 <code class=\"language-text\">serverless.yml</code> 파일에 정의한대로 AWS 리소스를 생성하는 과정들을 확인해볼 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"cli\"><pre class=\"language-cli\"><code class=\"language-cli\">Serverless: Using configuration:\n{\n  &quot;webpackConfig&quot;: &quot;./webpack.config.js&quot;,\n  &quot;includeModules&quot;: true,\n  &quot;packager&quot;: &quot;npm&quot;,\n  &quot;packagerOptions&quot;: {},\n  &quot;keepOutputDirectory&quot;: false\n}\nServerless: Removing /home/saegeullee/folders/udacity/serverless/10-udagram-app/.webpack\nServerless: Bundling with Webpack...\nTime: 460ms\nBuilt at: 2020-06-26 20:57:44\n         Asset      Size  Chunks                   Chunk Names\n    handler.js  1.28 KiB       0  [emitted]        handler\nhandler.js.map  5.27 KiB       0  [emitted] [dev]  handler\nEntrypoint handler = handler.js handler.js.map\n[0] ./handler.ts 316 bytes {0} [built]\n[1] external &quot;source-map-support/register&quot; 42 bytes {0} [built]\nServerless: Fetch dependency graph from /home/saegeullee/folders/udacity/serverless/10-udagram-app/package.json\nServerless: Package lock found - Using locked versions\nServerless: Packing external modules: source-map-support@^0.5.10\nServerless: Package took [2301 ms]\nServerless: Copy modules: /home/saegeullee/folders/udacity/serverless/10-udagram-app/.webpack/service [55 ms]\nServerless: Prune: /home/saegeullee/folders/udacity/serverless/10-udagram-app/.webpack/service [645 ms]\nServerless: Run scripts: /home/saegeullee/folders/udacity/serverless/10-udagram-app/.webpack/service [0 ms]\nServerless: Zip service: /home/saegeullee/folders/udacity/serverless/10-udagram-app/.webpack/service [114 ms]\nServerless: Packaging service...\nServerless: Remove /home/saegeullee/folders/udacity/serverless/10-udagram-app/.webpack\nServerless: Creating Stack...\nServerless: Checking Stack create progress...\nCloudFormation - CREATE_IN_PROGRESS - AWS::CloudFormation::Stack - serverless-udagram-app-dev\nCloudFormation - CREATE_IN_PROGRESS - AWS::S3::Bucket - ServerlessDeploymentBucket\nCloudFormation - CREATE_IN_PROGRESS - AWS::S3::Bucket - ServerlessDeploymentBucket\nCloudFormation - CREATE_COMPLETE - AWS::S3::Bucket - ServerlessDeploymentBucket\nCloudFormation - CREATE_IN_PROGRESS - AWS::S3::BucketPolicy - ServerlessDeploymentBucketPolicy\nCloudFormation - CREATE_IN_PROGRESS - AWS::S3::BucketPolicy - ServerlessDeploymentBucketPolicy\nCloudFormation - CREATE_COMPLETE - AWS::S3::BucketPolicy - ServerlessDeploymentBucketPolicy\nCloudFormation - CREATE_COMPLETE - AWS::CloudFormation::Stack - serverless-udagram-app-dev\nServerless: Stack create finished...\nServerless: Uploading CloudFormation file to S3...\nServerless: Uploading artifacts...\nServerless: Uploading service serverless-udagram-app.zip file to S3 (289.49 KB)...\nServerless: Validating template...\nServerless: Updating Stack...\nServerless: Checking Stack update progress...\nCloudFormation - UPDATE_IN_PROGRESS - AWS::CloudFormation::Stack - serverless-udagram-app-dev\nCloudFormation - CREATE_IN_PROGRESS - AWS::IAM::Role - IamRoleLambdaExecution\nCloudFormation - CREATE_IN_PROGRESS - AWS::ApiGateway::RestApi - ApiGatewayRestApi\nCloudFormation - CREATE_IN_PROGRESS - AWS::Logs::LogGroup - HelloLogGroup\nCloudFormation - CREATE_IN_PROGRESS - AWS::IAM::Role - IamRoleLambdaExecution\nCloudFormation - CREATE_IN_PROGRESS - AWS::ApiGateway::RestApi - ApiGatewayRestApi\nCloudFormation - CREATE_IN_PROGRESS - AWS::Logs::LogGroup - HelloLogGroup\nCloudFormation - CREATE_COMPLETE - AWS::Logs::LogGroup - HelloLogGroup\nCloudFormation - CREATE_COMPLETE - AWS::ApiGateway::RestApi - ApiGatewayRestApi\nCloudFormation - CREATE_IN_PROGRESS - AWS::ApiGateway::Resource - ApiGatewayResourceHello\nCloudFormation - CREATE_IN_PROGRESS - AWS::ApiGateway::Resource - ApiGatewayResourceHello\nCloudFormation - CREATE_COMPLETE - AWS::ApiGateway::Resource - ApiGatewayResourceHello\nCloudFormation - CREATE_COMPLETE - AWS::IAM::Role - IamRoleLambdaExecution\nCloudFormation - CREATE_IN_PROGRESS - AWS::Lambda::Function - HelloLambdaFunction\nCloudFormation - CREATE_IN_PROGRESS - AWS::Lambda::Function - HelloLambdaFunction\nCloudFormation - CREATE_COMPLETE - AWS::Lambda::Function - HelloLambdaFunction\nCloudFormation - CREATE_IN_PROGRESS - AWS::Lambda::Permission - HelloLambdaPermissionApiGateway\nCloudFormation - CREATE_IN_PROGRESS - AWS::ApiGateway::Method - ApiGatewayMethodHelloGet\nCloudFormation - CREATE_IN_PROGRESS - AWS::Lambda::Version - HelloLambdaVersionM6DbLxpdiG16YDJDg2ZSMu4TSoZ5fRB1obTCtaxOz4\nCloudFormation - CREATE_IN_PROGRESS - AWS::Lambda::Permission - HelloLambdaPermissionApiGateway\nCloudFormation - CREATE_IN_PROGRESS - AWS::ApiGateway::Method - ApiGatewayMethodHelloGet\nCloudFormation - CREATE_COMPLETE - AWS::ApiGateway::Method - ApiGatewayMethodHelloGet\nCloudFormation - CREATE_IN_PROGRESS - AWS::Lambda::Version - HelloLambdaVersionM6DbLxpdiG16YDJDg2ZSMu4TSoZ5fRB1obTCtaxOz4\nCloudFormation - CREATE_COMPLETE - AWS::Lambda::Version - HelloLambdaVersionM6DbLxpdiG16YDJDg2ZSMu4TSoZ5fRB1obTCtaxOz4\nCloudFormation - CREATE_IN_PROGRESS - AWS::ApiGateway::Deployment - ApiGatewayDeployment1593172663349\nCloudFormation - CREATE_IN_PROGRESS - AWS::ApiGateway::Deployment - ApiGatewayDeployment1593172663349\nCloudFormation - CREATE_COMPLETE - AWS::ApiGateway::Deployment - ApiGatewayDeployment1593172663349\nCloudFormation - CREATE_COMPLETE - AWS::Lambda::Permission - HelloLambdaPermissionApiGateway\nCloudFormation - UPDATE_COMPLETE_CLEANUP_IN_PROGRESS - AWS::CloudFormation::Stack - serverless-udagram-app-dev\nCloudFormation - UPDATE_COMPLETE - AWS::CloudFormation::Stack - serverless-udagram-app-dev\nServerless: Stack update finished...\nService Information\nservice: serverless-udagram-app\nstage: dev\nregion: us-east-1\nstack: serverless-udagram-app-dev\nresources: 11\napi keys:\n  None\nendpoints:\n  GET - https://flynaqxkge.execute-api.us-east-1.amazonaws.com/dev/hello\nfunctions:\n  hello: serverless-udagram-app-dev-hello\nlayers:\n  None\n\nStack Outputs\nHelloLambdaFunctionQualifiedArn: arn:aws:lambda:us-east-1:685808903701:function:serverless-udagram-app-dev-hello:1\nServiceEndpoint: https://flynaqxkge.execute-api.us-east-1.amazonaws.com/dev\nServerlessDeploymentBucketName: serverless-udagram-app-d-serverlessdeploymentbuck-tdi6ddkua4zw\n\nServerless: Run the &quot;serverless&quot; command to setup monitoring, troubleshooting and testing.</code></pre></div>\n<p>위 로그의 끝 부분에서 생성된 엔드포인트 주소로 포스트맨을 활용하여 요청을 보내보면 다음과 같이 응답이 성공적으로 오는 것을 알 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"message\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Go Serverless Webpack (Typescript) v1.0! Your function executed successfully!\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"input\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token property\">\"resource\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"/hello\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token property\">\"path\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"/hello\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token property\">\"httpMethod\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"GET\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token property\">\"headers\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n          ...</code></pre></div>\n<p>AWS CloudFormation 대시보드에서 위의 명령어로 생성된 Stack을 확인해 볼 수 있고 CloudFormation이 이 Stack에 생성한 각 리소스를 API 게이트웨이, AWS 람다 함수 등의 대시보드에서 확인해볼 수 있다.</p>\n<h2 id=\"groups-api-추가하기\"><a href=\"#groups-api-%EC%B6%94%EA%B0%80%ED%95%98%EA%B8%B0\" aria-label=\"groups api 추가하기 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Groups API 추가하기</h2>\n<p>여기서 진행할 내용은 다음과 같다.</p>\n<ul>\n<li>GET /groups 엔드포인트에 요청을 보내기 위한 함수 추가</li>\n<li>\n<p>환경설정</p>\n<ul>\n<li>Event Handler 생성</li>\n<li>IAM permission 설정</li>\n<li>DynamoDB table 생성</li>\n</ul>\n</li>\n<li>POST /groups 엔드포인트 추가</li>\n</ul>\n<p>위의 진행 내용은 <a href=\"https://github.com/saegeullee/Serverless_Framework_App\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">깃헙 레포지토리</a>에서 확인이 가능하다.</p>\n<h2 id=\"요청-유효성-검증\"><a href=\"#%EC%9A%94%EC%B2%AD-%EC%9C%A0%ED%9A%A8%EC%84%B1-%EA%B2%80%EC%A6%9D\" aria-label=\"요청 유효성 검증 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>요청 유효성 검증</h2>\n<p>현재 위에서 구현한 POST <code class=\"language-text\">/groups</code> 엔드포인트에서는 사용자의 요청을 받으면 그 데이터를 DB에 어떤 유효성 검증이 없이 저장을 하고 있다. 클라이언트의 요청으로 받은 body 객체에 유효성 검증을 람다 함수에서 진행할 수 있지만 여기서는 <code class=\"language-text\">API 게이트웨이</code>에서 하는 방법을 알아본다. 이 방식으로 진행하면 람다 함수가 호출되기 전에 <code class=\"language-text\">API 게이트웨이</code>에서 먼저 요청의 유효성이 검증된다. 검증되지 않은 요청은 람다 함수 호출자체를 하지 않기 때문에 비용을 절감할 수 있다.</p>\n<h3 id=\"json-스키마\"><a href=\"#json-%EC%8A%A4%ED%82%A4%EB%A7%88\" aria-label=\"json 스키마 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>JSON 스키마</h3>\n<p>API 게이트웨이에서 들어오는 요청을 검증하기 위해 <a href=\"https://json-schema.org/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">JSON 스키마</a>를 사용한다. JSON 스키마는 JSON 객체의 구조를 정의한다. 다음은 JSON 스키마 예시이다. 첫번째 프로퍼티인 <code class=\"language-text\">$schema</code>는 JSON 객체의 유효성 검증이 이루어질때 어떤 버전의 JSON 스키마가 사용되어야 하는지를 명시한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"$schema\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"http://json-schema.org/draft-04/schema#\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"title\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"my-type\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"object\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"properties\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"string\"</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"required\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"name\"</span><span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>API 게이트웨이에서 요청을 검증하는 방법에 대한 공식 문서는 <a href=\"https://docs.aws.amazon.com/apigateway/latest/developerguide/api-gateway-method-request-validation.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">여기서</a> 확인할 수 있다.</p>\n<p>서버리스 프레임워크를 사용하여 요청에 대한 유효성 검증을 하려면 <code class=\"language-text\">serverless.yml</code> 파일의 해당 핸들러에 다음과 같이 코드를 추가하면 된다.</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">HttpHandler</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">handler</span><span class=\"token punctuation\">:</span> src/lambda/http/create.handler\n  <span class=\"token key atrule\">events</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">http</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">method</span><span class=\"token punctuation\">:</span> post\n        <span class=\"token key atrule\">path</span><span class=\"token punctuation\">:</span> items\n        <span class=\"token key atrule\">request</span><span class=\"token punctuation\">:</span>\n          <span class=\"token comment\"># Schema that will be used to validate incoming requests</span>\n          <span class=\"token key atrule\">schema</span><span class=\"token punctuation\">:</span>\n            <span class=\"token key atrule\">application/json</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span>file(models/create<span class=\"token punctuation\">-</span>todo<span class=\"token punctuation\">-</span>model.json)<span class=\"token punctuation\">}</span></code></pre></div>\n<h2 id=\"images-api-추가\"><a href=\"#images-api-%EC%B6%94%EA%B0%80\" aria-label=\"images api 추가 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Images API 추가</h2>\n<p>여기서 구현할 내용은 다음과 같다.</p>\n<ul>\n<li>이미지 생성</li>\n<li>해당 group의 이미지 get</li>\n<li>특정 id의 이미지 get</li>\n<li>이미지 업로드</li>\n<li>이미지 업로드 노티피케이션</li>\n</ul>\n<p>여기서 사용하는 DynamoDB의 파티션 키만을 사용해서는 특정 id의 이미지를 get하는 쿼리만 구현이 가능하고 특정 group의 모든 이미지를 get하는 쿼리를 구현하기는 어렵다.</p>\n<p>따라서 이 기능을 구현하기 위해 DynamoDB에서 제공하는 <code class=\"language-text\">Composite Key</code>(컴포짓 키)를 사용해야 한다. 컴포짓 키는 다음 두가지 키로 구성이 된다.</p>\n<ul>\n<li>파티션 키 : 아이템을 어떤 파티션에 write 할지를 결정</li>\n<li>sort 키 : 같은 파티션 키의 아이템들을 sorting</li>\n<li>이 둘을 함께 사용하면 하나의 아이템을 유니크하게 만들 수 있다.</li>\n<li>이 구조는 주로 RDBMS의 <code class=\"language-text\">One to Many</code> 관계를 DynamoDB에서 구현하기 위해 사용한다.</li>\n</ul>\n<p>컴포짓 키를 사용하면 DynamoDB에 <code class=\"language-text\">Query</code>라는 추가적인 오퍼레이션이 가능한데 이는 특정 파티션 키를 가지고 있는 모든 엘리먼트를 쿼리할 수 있다. 이는 큰 데이터베이스를 쿼리할 때 효율이 좋다. 데이터베이스의 모든 엘리먼트를 scan할 필요없이 특정 파티션 키만을 가지고 있는 아이템만 read 할 수 있기 때문이다. 또한 <code class=\"language-text\">sort key</code>와 다른 속성으로 아이템을 필터링 할 수 있다.</p>\n<h3 id=\"컴포짓-키가-제공하는-오퍼레이터\"><a href=\"#%EC%BB%B4%ED%8F%AC%EC%A7%93-%ED%82%A4%EA%B0%80-%EC%A0%9C%EA%B3%B5%ED%95%98%EB%8A%94-%EC%98%A4%ED%8D%BC%EB%A0%88%EC%9D%B4%ED%84%B0\" aria-label=\"컴포짓 키가 제공하는 오퍼레이터 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>컴포짓 키가 제공하는 오퍼레이터</h3>\n<ul>\n<li>\n<p>아이템을 필터링할 때 사용할 수 있는 오퍼레이터는 다음과 같다.</p>\n<ul>\n<li>sort key의 값으로 해당 오퍼레이터 사용가능</li>\n</ul>\n</li>\n<li>&#x3C;, >, &#x3C;=, >=, =</li>\n<li>BETWEEN</li>\n<li>BEGINS_WITH</li>\n</ul>\n<h3 id=\"이미지-테이블\"><a href=\"#%EC%9D%B4%EB%AF%B8%EC%A7%80-%ED%85%8C%EC%9D%B4%EB%B8%94\" aria-label=\"이미지 테이블 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>이미지 테이블</h3>\n<p>이 수업에서 Images API를 구현하기 위해 이미지 테이블 필드는 다음과 같이 구성한다.</p>\n<ul>\n<li>groupId (파티션 키)</li>\n<li>timestamp (sort 키)</li>\n<li>imageId</li>\n<li>title</li>\n<li>imageUrl</li>\n</ul>\n<h2 id=\"nodejs에서-쿼리-샘플-코드\"><a href=\"#nodejs%EC%97%90%EC%84%9C-%EC%BF%BC%EB%A6%AC-%EC%83%98%ED%94%8C-%EC%BD%94%EB%93%9C\" aria-label=\"nodejs에서 쿼리 샘플 코드 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Nodejs에서 쿼리 샘플 코드</h2>\n<p>DynamoDB의 도큐먼트 클라이언트가 Nodejs에서 DB를 쿼리하기 위한 샘플 코드이다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> docClient <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">AWS<span class=\"token punctuation\">.</span>DynamoDB<span class=\"token punctuation\">.</span>DocumentClient</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> result <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> docClient\n  <span class=\"token punctuation\">.</span><span class=\"token function\">query</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    TableName<span class=\"token punctuation\">:</span> <span class=\"token string\">'GameScore'</span><span class=\"token punctuation\">,</span>\n    KeyConditionExpression<span class=\"token punctuation\">:</span> <span class=\"token string\">'GameId = :gameId'</span><span class=\"token punctuation\">,</span>\n    ExpressionAttributeValues<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token string\">':gameId'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'10'</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">promise</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> items <span class=\"token operator\">=</span> result<span class=\"token punctuation\">.</span>Items<span class=\"token punctuation\">;</span></code></pre></div>\n<h3 id=\"serverless-프레임워크-샘플-코드\"><a href=\"#serverless-%ED%94%84%EB%A0%88%EC%9E%84%EC%9B%8C%ED%81%AC-%EC%83%98%ED%94%8C-%EC%BD%94%EB%93%9C\" aria-label=\"serverless 프레임워크 샘플 코드 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>serverless 프레임워크 샘플 코드</h3>\n<p>특정 그룹의 모든 이미지를 가져오는 엔드포인트에 대한 명세를 <code class=\"language-text\">serverless.yml</code>에 다음과 같이 정의할 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">functions</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">GetOrders</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">handler</span><span class=\"token punctuation\">:</span> src/images.handler\n    <span class=\"token key atrule\">events</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">http</span><span class=\"token punctuation\">:</span>\n          <span class=\"token key atrule\">method</span><span class=\"token punctuation\">:</span> get\n          <span class=\"token key atrule\">path</span><span class=\"token punctuation\">:</span> /groups/<span class=\"token punctuation\">{</span>groupId<span class=\"token punctuation\">}</span>/images</code></pre></div>\n<p>그리고 핸들러 함수는 다음과 같이 작성할 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">exports<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">handler</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> groupId <span class=\"token operator\">=</span> event<span class=\"token punctuation\">.</span>pathParameters<span class=\"token punctuation\">.</span>groupId\n  <span class=\"token operator\">...</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2 id=\"dyanamodb-인덱싱\"><a href=\"#dyanamodb-%EC%9D%B8%EB%8D%B1%EC%8B%B1\" aria-label=\"dyanamodb 인덱싱 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>DyanamoDB 인덱싱</h2>\n<p>DynamoDB의 인덱싱 시스템은 다른 데이터베이스의 시스템과 다르다. DynamoDB는 두가지 타입의 인덱싱을 지원한다.</p>\n<h3 id=\"local-secondary-indexlsi\"><a href=\"#local-secondary-indexlsi\" aria-label=\"local secondary indexlsi permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Local Secondary Index(LSI)</h3>\n<ul>\n<li>추가적인 sort key와 같다.</li>\n<li>다른 속성으로 아이템을 정렬할 수 있도록 해준다.</li>\n</ul>\n<h3 id=\"global-secondary-indexgsi\"><a href=\"#global-secondary-indexgsi\" aria-label=\"global secondary indexgsi permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Global Secondary Index(GSI)</h3>\n<ul>\n<li>같은 데이터에 대해 새로운 파티션 키와 sort 키를 정의할 수 있다.</li>\n<li>파티션 키를 새로운 키로 하여 테이블의 데이터를 비동기로 복사한다.</li>\n</ul>\n<p>이 수업 예시의 경우에는 <code class=\"language-text\">imageId</code>가 <code class=\"language-text\">GSI</code>가 될 수 있다. 따라서 imageID로 아이템을 쿼리해올 수 있게 된다. <code class=\"language-text\">GSI</code>로 설정했기 때문에 쿼리 속도가 빠르고 테이블의 모든 아이템을 lookup 할 필요가 없다.</p>\n<h1 id=\"event-processing\"><a href=\"#event-processing\" aria-label=\"event processing permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Event Processing</h1>\n<p>지금까지의 과정까지 <code class=\"language-text\">serverless framework</code>를 사용하여 <a href=\"https://github.com/saegeullee/Serverless_Framework_App\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">SNS 어플리케이션</a>을 만들었다. 이번 섹션에서는 다음의 고급 기능들을 이 어플리케이션에 추가하는 과정들을 정리한다.</p>\n<ul>\n<li>AWS S3에 이미지 업로드</li>\n<li>\n<p>이미지 파일이 업로드 될때 다른 사용자들에게 노티 보내주기</p>\n<ul>\n<li>WebSockets</li>\n<li>S3 노티피케이션 사용</li>\n</ul>\n</li>\n<li>텍스트 검색 (DynamoDB)</li>\n<li>\n<p>아마존 SNS(Simple Notification Service) 사용</p>\n<ul>\n<li>람다 함수와 이벤트 소스들 연결</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"파일-업로드\"><a href=\"#%ED%8C%8C%EC%9D%BC-%EC%97%85%EB%A1%9C%EB%93%9C\" aria-label=\"파일 업로드 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>파일 업로드</h2>\n<p>이 수업에서 이미지를 업로드 할 때 <code class=\"language-text\">presigned url</code>이라는 방식을 사용한다.</p>\n<h3 id=\"presigned-url\"><a href=\"#presigned-url\" aria-label=\"presigned url permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Presigned URL</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 785px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/ef88214393d4611d3f43268d1bf238de/6e706/presigned_url.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 49.80891719745223%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsSAAALEgHS3X78AAABrklEQVQoz31RW07CUBDtevxxD67AHbgD44eJiV9uwD+jJi6AL2s0EYUAysMEDJU2jYmxIlSLIIUmbeXRF8c7F0tE0Zuc3OnMOWfmToXJZIL/ju/56HQ6sCxrYf2nXoiTURTxezwew+yaME0Tkwgwui9YP1hDIn/EBUEYcG4M0nwHN6QCGQVBAN/3MRqNMBwNucGToWF1ZwWHyd3pxKwe8zzP+zXxzJBIfx0SUhO6vbHH+bF53CDwp5PPDKmwaCf8KWGIwccHHMeF67qz5vQqx3bQar2h37e4x2yHIRPF5kRyHIfn/vtlQRjN7Z/vcDAYwLZt9hN63IRQrz+j2WjAZrHd66FflWDX63AZt8d4NmtIE1vvbTYxi1k+hmAYBhRFQaFYgqZpaDCjZlOHTnerhQeWzy0tQ93axnO7DVVW8Pio4UGVISUTeLpX8PJqQNd1DkGWZZRKN7i+zqNSqUBi0xSLRRTyBUi1GvKXKYgbm0jv7aOmqlAYnzR31SrKuRSk2zL7VlBjXIKQyWSQzWY5KCaIxyJE8YTHyYsLnKUucXp+jnQ6jcwXj2tyV3M6wieWjOTYj8nTagAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n        <source\n          srcset=\"/static/ef88214393d4611d3f43268d1bf238de/8ac56/presigned_url.webp 240w,\n/static/ef88214393d4611d3f43268d1bf238de/d3be9/presigned_url.webp 480w,\n/static/ef88214393d4611d3f43268d1bf238de/f2d53/presigned_url.webp 785w\"\n          sizes=\"(max-width: 785px) 100vw, 785px\"\n          type=\"image/webp\"\n        />\n        <source\n          srcset=\"/static/ef88214393d4611d3f43268d1bf238de/e4891/presigned_url.png 240w,\n/static/ef88214393d4611d3f43268d1bf238de/0ce91/presigned_url.png 480w,\n/static/ef88214393d4611d3f43268d1bf238de/6e706/presigned_url.png 785w\"\n          sizes=\"(max-width: 785px) 100vw, 785px\"\n          type=\"image/png\"\n        />\n        <img\n          class=\"gatsby-resp-image-image\"\n          src=\"/static/ef88214393d4611d3f43268d1bf238de/6e706/presigned_url.png\"\n          alt=\"presigned_url\"\n          title=\"presigned_url\"\n          loading=\"lazy\"\n          style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        />\n      </picture>\n  </a>\n    </span></p>\n<ul>\n<li>S3 버켓을 가리키는 특별한 URL이다</li>\n<li>\n<p>누구나 이를 사용하여 객체를 업로드 및 Read 할 수 있다</p>\n<ul>\n<li>S3 버켓이 Private 이더라도 사용가능</li>\n</ul>\n</li>\n<li>\n<p>람다 함수에 의해 <code class=\"language-text\">Presigned url</code>이 생성된다</p>\n<ul>\n<li>해당 람다 함수는 S3에 쓰기 권한이 있어야 한다</li>\n</ul>\n</li>\n<li>\n<p>serverless 방식이다.</p>\n<ul>\n<li>파일 업로드를 위한 인프라를 관리할 필요가 없다</li>\n<li>파일 업로드 프로세싱을 직접 관리할 필요가 없다</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"presigned-url-생성하기\"><a href=\"#presigned-url-%EC%83%9D%EC%84%B1%ED%95%98%EA%B8%B0\" aria-label=\"presigned url 생성하기 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Presigned URL 생성하기</h3>\n<p><code class=\"language-text\">presigned url</code>을 생성하기 위해서는 다음과 같이 S3 버켓 클라이언트 인스턴스를 생성해야 한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> s3 <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">AWS<span class=\"token punctuation\">.</span>S3</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  signatureVersion<span class=\"token punctuation\">:</span> <span class=\"token string\">'v4'</span> <span class=\"token comment\">// Use Sigv4 algorithm</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> presignedUrl <span class=\"token operator\">=</span> s3<span class=\"token punctuation\">.</span><span class=\"token function\">getSignedUrl</span><span class=\"token punctuation\">(</span><span class=\"token string\">'putObject'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// 이 URL은 S3 버켓에 PUT 작업을 할 수 있도록 허용한다.</span>\n  Bucket<span class=\"token punctuation\">:</span> <span class=\"token string\">'s3-bucket-name'</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// S3 버켓의 이름</span>\n  Key<span class=\"token punctuation\">:</span> <span class=\"token string\">'object-id'</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// 이 URL이 접근 허용하는 객체의 id</span>\n  Expires<span class=\"token punctuation\">:</span> <span class=\"token string\">'300'</span> <span class=\"token comment\">// 이 URL은 5분동안 유효함</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>이 url을 생성하기 위해 사용되는 Sigv4 알고리즘이 어떻게 동작하는지에 대한 것은 <a href=\"https://docs.aws.amazon.com/general/latest/gr/signature-version-4.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">여기서</a> 확인해보면 된다.</p>\n<h3 id=\"cloudformation-레퍼런스\"><a href=\"#cloudformation-%EB%A0%88%ED%8D%BC%EB%9F%B0%EC%8A%A4\" aria-label=\"cloudformation 레퍼런스 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>CloudFormation 레퍼런스</h3>\n<p>현재 프로젝트에 어떤 사용자든지 S3 버켓에서 이미지를 읽어올 수 있도록 허용하는 것과 S3 버켓에 이미지를 업로드 할 수 있도록 허용하는 <code class=\"language-text\">IAM 정책</code>을 추가해야 한다. 그러기 위해서는 <code class=\"language-text\">IAM 정책</code>이 S3 버켓의 ID를 알 수 있어야 한다. 이때 <code class=\"language-text\">CloudFormation 레퍼런스</code>를 사용하여 다음과 같이 이를 제공할 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">AttachmentBucket</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">Type</span><span class=\"token punctuation\">:</span> AWS<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span>S3<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span>Bucket\n\n<span class=\"token key atrule\">BucketPolicy</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">Type</span><span class=\"token punctuation\">:</span> AWS<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span>S3<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span>BucketPolicy\n  <span class=\"token key atrule\">Properties</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">PolicyDocument</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token tag\">!Ref</span> AttachmentsBucket</code></pre></div>\n<p><a href=\"https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/intrinsic-function-reference-ref.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Ref</a>를 통해 특정 리소스의 id를 가져올 수 있다.</p>\n<p>YAML 파일에 다음의 두가지 포맷으로 사용할 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">Ref</span><span class=\"token punctuation\">:</span> logicalName</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token tag\">!Ref</span> logicalName</code></pre></div>\n<h2 id=\"s3-이벤트\"><a href=\"#s3-%EC%9D%B4%EB%B2%A4%ED%8A%B8\" aria-label=\"s3 이벤트 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>S3 이벤트</h2>\n<p>이번 섹션에서는 S3 파일 업로드 이벤트(s3 노티피케이션)가 발생했을때 호출되는 람다 함수를 추가한다. 서버리스 프레임워크에는 다음과 같이 함수를 정의하여 이를 수행할 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">functions</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">process</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">handler</span><span class=\"token punctuation\">:</span> file.handler\n    <span class=\"token key atrule\">events</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">s3</span><span class=\"token punctuation\">:</span> bucket<span class=\"token punctuation\">-</span>name\n        <span class=\"token key atrule\">events</span><span class=\"token punctuation\">:</span> s3<span class=\"token punctuation\">:</span>ObjectCreated<span class=\"token punctuation\">:</span>*\n        <span class=\"token key atrule\">rules</span><span class=\"token punctuation\">:</span>\n          <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">prefix</span><span class=\"token punctuation\">:</span> images/\n          <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">suffix</span><span class=\"token punctuation\">:</span> .png</code></pre></div>","fields":{"slug":"/serverless/serverless","tagSlugs":["/tag/serverless/"]},"frontmatter":{"date":"2020-06-16T11:50:37.121Z","description":"serverless","tags":["serverless"],"title":"serverless","socialImage":"/media/image-2.jpg"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/serverless/serverless"}}}